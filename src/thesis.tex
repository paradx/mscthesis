\documentclass[a4paper, english]{article}

% includes 
% Language setting
\usepackage[english]{babel}
\usepackage{csquotes}
\usepackage[iso]{isodate}
\usepackage[version=4]{mhchem} % for chemical reaction formulas
% Set page size and margins
\usepackage[top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}
%% images
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage[inkscapeformat=png]{svg}
%% captions 
\usepackage{caption}
\usepackage{subcaption}
%% tables 
\usepackage{booktabs}
%% colors
\usepackage{xcolor}
%% links and refs and citations 
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage[capitalize]{cleveref}
\usepackage[backend=biber, style=authoryear]{biblatex}
%% acronyms and glossary 
\usepackage[automake,acronyms,xindy,translate=babel]{glossaries} 
\usepackage{glossaries-extra}
%% include code snippets
\usepackage{listings}
%% maths
\usepackage{amsmath}
%% title page
\usepackage{titling} % for cooler titlepages 
% configuration 
\bibliography{refs.bib} % Entries are in the refs.bib file
% configure python code snippets
\lstdefinestyle{PyStyle}{%
    commentstyle=\color{olive},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{gray},
    stringstyle=\color{purple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
    language=python
}
% setup title 
\title{\textbf{\huge Impact of Climate and Land Cover Change in Urban Heat Islands}\\ \vspace{1.2cm} }
\author{Linus Andrae (6015384)}
\date{\today}

\makeglossaries%
% Acros
\newabbreviation{USGS} {USGS} {United States Geological Survey}
\newabbreviation{LST}  {LST}  {Land Surface Temperature}
\newabbreviation{LULC} {LULC} {Land Use/ Land Cover}
\newabbreviation{UHI}  {UHI}  {Urban Heat Island}
\newabbreviation{SUHI} {SUHI} {Surface Urban Heat Island}
\newabbreviation{NDVI} {NDVI} {Normalized Differential Vegetation Index}
\newabbreviation{HI}   {HI}   {Heat Index}
\newabbreviation{NIR}  {NIR}  {Near Infrared}
\newabbreviation{OSM}  {OSM}  {Open Street Map}
\newabbreviation{TOA}  {TOA}  {Top of Atmosphere}
\newabbreviation{VOC}  {VOC}  {Volatile Organic Compounds}
\newabbreviation{ML}   {ML}   {Machine Learning}
\newabbreviation{SVM}  {SVM}  {Support Vector Machine}
\newabbreviation{ECMWF}{ECMWF}{European Center for Medium-Range Weather Forcasts}
\newabbreviation{WBGT} {WBGT} {Wet Bulb Globe Temperature}


\begin{document}
  \input{title}
  \newpage

  \input{abstact}
  \newpage
  % TODO insert Eigenständigkeitserklärung

  \tableofcontents
  \listoffigures
  \listoftables

  \section*{Acronyms}
  \printglossaries%
  %\begin{acronym}
      %\end{acronym}
\newpage

\section{A historical introduction of urban heat island research}
  The scientific investigation of the urban climate and the influence of human settlements and activity on the local atmosphere and temperature has been studied for more then 200 years.%
~\cite{Howard1833}~investigated the climate of London in a study from 1819 to 1827 and a similar study was conducted in Paris in the 1850s by~\cite{renou1862differences}.%
  The first mobile measurement campaigns by~\cite{peppler1929auto} and investigations of the spacial distribution of temperatures where conducted in the 1920s in Germany and Austria~\cite{tollner1932untersuchungen}, and where repeated in multiple cities around the globe.\\%todo add more refs? 
  The term Urban Heat Island was coined in the 1960s in publications regarding case studies in London~\cite{Chandler1961} and Montreal~\cite{Oke1968}.
  During this time the influences and understanding of the interaction between the human industrial activity, the land change and the influence on temperatures was investigated by numerous case studies using fixed or mobile weather stations.
  The first use of helicopters and airplanes to measure vertical temperature profiles where documented in the 1950s  
  %TODO add source 
  All these studies focused on the atmospheric heat distribution over urban areas and resulted in the development of physical energy transport models for these. 
  These models required a deeper understanding of the surface properties and the temperature distribution within the urban area. 
  % 
  Then newly available remote sensing devices such as infrared imagers made it possible to observe the urban environment from above and detect temperature hot spots using airborne and satellite images.  
  %  
  First investigations regarding the feasibility of this approach where proposed in the late 70s (\cite{Watson1975},~\cite{Carlson1977} and~\cite{Block1978}) but the resolution of satellite images insufficient for detailed investigations of Urban Heat Islands.\\
  A first study using satellite infrared imagery where conducted in 1978 using the NOAA 5 Satellite (with a spacial resolution of 1km)\cite{Matson1978}. 
  Multiple studies in the 70s and 80s used images taken from planes or helicopters to aid the investigation of smaller scale effects within the urban surface temperature distribution (e.g.~\cite{Landsberg1979},~\cite{ljungberg1980use} and~\cite{Foster1981}).
  With advances in satellite technology the resolution and data availability increased. 
  The Landsat program stared in 1975 and since \textit{Landsat 4} was launched in 1982 the Landsat program continuously provides thermal infrared data of the whole planet. 
  The increased resolution that allows pixel sizes between 60 m (\textit{Landsat 7}) and 120 m (\textit{Landsat 4} and \textit{Landsat 5}), allows investigation of smaller patterns within urban areas.\\
  Increased revisit frequency of roughly two weeks made remote satellite data a more useful and widely used tool in the research of urban meteorology and urban heat islands. 
  % Add the 2008 - 2010
  
  \subsection{Research Question}
    In this thesis the impact of change in land cover (urbanisation, urban development and other land use changes) and the impact of rising average temperature shall be investigated with regards to the urban heat island phenomena.

    \subsection{Methodology}
    % SUHI measurements using Thermal Infrared Satellite Data 
    
    % LULC impact using ML algorithm to create time lines of LULC of example cities

    % Measurment of UHI intesity over time 

    % Modelling of UHI into the future 

    % Application of different Indicies for measuring heat stress and other parameters for juding UHI intesity

    % Outlook and further research

    \subsection{Structure of the Thesis}
    In the introduction as well as \cref{sec:background} previous work and an overview of the current understanding of the urban heat island effect and research in this area is accessed. 
%comparable definition
    \Cref{sec:definition} combines the work of~\cite{Sobrino2020} and %TODO 
    to create a definition of surface urban heat islands that is usable for comparing \glspl{UHI} in different cities.  
    \Cref{sec:LULC} measures and investigates the impact of land use and land cover changes by building
    In \Cref{sec:UHIInt} the impact of changing temperatures an increase of extreme weather phenomena on the intensity and seasonal variety of \glspl{UHI} is investigated 

   \input{background}

%\section*{Acknowledgements}

\section{Theoretical Background}
    \input{ndvi}
    \newpage
    \subsubsection{Heat Index}
    The \gls{HI}is a temperature index that takes sultriness into account and rates the impact of temperature and air humidity of the human body. 
    The output of this temperature scale (given in °C) is the apparent temperature, depending on relative air humidity. 
    The defined range is between 20 °C and 50°C dry bulb temperature and up to 90\% relative humidity~\cite[p. 862]{Steadman1979}. 
    The proposed heat index is based on a model human and takes wind chill and clothing into account, to produce a apparent temperature of human. 
    The heat index can be used as a good reference for non-extreme conditions. 
    Its biggest downside is the missing account for direct insolation on body temperature and comfort.
    The Heat Index later is used to compare different \glspl{UHI} with each other.


    \subsubsection{Wet Bulb Globe Temperature}
    To account the impact of insolation on the human body and how it reacts to heat stress differently in different environmental conditions, the Wet Bulb Globe Temperature was developed. 
    Working under heat stress poses a serious health issue, for this the \gls{WBGT} was defined as EN ISO 7243:2017, calculating the thermal load on the human body\cite{14001700}
    Heat exchange between the human body and the environment is dominated by evaporation of secreted sweat.
    The efficiency of this process is determined by the vapor pressure, that is influenced by temperature difference and the humidity difference. %TODO ref paper with caves
    The Heat Index is a simple way of calculating this efficiency that does not take radiant heat into account, the WBGT does incorporated this effect as well as clothing in this process. 


    \subsubsection{Urban Air Quality}
    Large urbanized areas are susceptible to air pollution due to increased combustion and industrial activity. % TODO Numerous studies \cite{Kanakidou2011}
    One major pollutant with a significant health impact is tropospheric ozone that is produced in larger quantities within higher temperature environments (see~\cite{Ebi2008}). 
    Ozone is mainly produced when (anthropogenic) NO\textsubscript{x} emissions and other \glspl{VOC} react with volatile organic compounds. %todo source
    The creation of ozone is dependent on temperature, increasing between 2.2 and 3.2 ppbv/°C depending on NO\textsubscript{x}

    %\subsection{Models and Theories}
    \section{Image Processing}\label{sec:imgProcessing}
    Using remote sensing data for scientific purposes requires a (a) systematic, (b) reproducable, (c) verifiable way of detecting patterns and information within the data. \\ 
    The field of image processing and machine learning has developed a wide range of tools that are used in many different fields over the past decades. % TODO might want to add examples here ? 
    \subsection{Machine Learning}\label{sec:ml}
    The term machine learning describes a set of algorithms that use a set of training data, detect statistical correlations using different weights to approximate this data. %TODO external source 
    These approximations can be stored and be used to detect the same features within new but similar data.
    
    In the next sections the image processing steps are described from a technical perspective and the underlying mathematical frameworks are discussed.

    \subsection{Gabor Feature Detection}\label{sec:gabor}
    The Gabor filter is an linear filter, that uses a convolution of an image with a wavelet created by rotating a sine modulated gaussian, this kernel type is also called the \textit{gabor wavelet}. 
    In image processing this algorithm is used as an feature extraction algorithm to extract and analyse texture and structures with different sizes within the image~(\cite{Cerdan1993}). 
    By rotating the kernel and changing the frequency, different textures are extracted from the image.
%
    Mathematically the gabor filter is defined by
    \begin{equation}
      g(x,y; \lambda, \theta, \phi, \sigma, \gamma) = \exp \left(- \frac{x'^2 + \gamma^2\cdot y'^2}{2\sigma^2}\right) \cdot \exp \left[i \left(2\pi\frac{x}{\lambda} + \phi \right)\right] 
    \end{equation}
    With $ x' = x \cos(\phi) + y \sin(\phi)~\text{and}~y' = -x \sin(\phi) + y \cos(\phi)$.
%
    The x and y parameter determine the kernel size, this parameter should be chosen based on the image size and expected structure length.\\
    $\gamma$ is the aspect ratio of the kernel, with $\gamma = 1$ the kernel is round, for smaller $\gamma$ the kernel becomes a more eccentric ellipse.\\
    $\phi$ is the angle of rotation of the sine component of the kernel. \\
    $\theta$ is the angle of rotation of the kernel, detecting differently oriented features.\\
    $\lambda$ is the wavelength of the sine wave. \\
    $\sigma$ is the standard deviation of the Gaussian distribution\\ 
    %TODO add more accurate description of parameters
%
    To detect different structures of different scales within the image, a filter bank can be created by combining multiple filters and varying $\phi$, $\sigma$ and $\theta$.\\
%
    After the convolution of the image with the filter bank, the resulting set of detected features can be used as an input into different algorithms.
    \Cref{fig:gaborExample} shows different kernel sizes and rotations on an satellite image of Bremen. 
    It can be seen that the different structures such as fields (seen in \cref{fig:feat02} and \cref{fig:feat05}) or larger structures and water bodies (seen in \cref{fig:feat01} and \cref{fig:feat03}).
    The output of the filter is an tensor that contains a binary image sized matrix per filter. Each layer provides meta information for each pixel, if it is part of a larger scale texture or pattern. 
    This meta information is used in surface classification (\cref{sec:classification}).

    \begin{figure}[!htbp]
       \centering
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{img/Features_2_005_0.png}
         \caption{Kernel with $\sigma$ = 2, f = 0.05 and 0 ° rotation}\label{fig:feat01}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{img/Features_2_015_0.png}
         \caption{Kernel with $\sigma$ = 2, f = 0.15 and 0 ° rotation}\label{fig:feat02}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{img/Features_4_005_0.png}
         \caption{Kernel with $\sigma$ = 4, f = 0.05 and 0 ° rotation}\label{fig:feat03}
     \end{subfigure}

     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{img/Features_2_005_90.png}
         \caption{Kernel with $\sigma$ = 2, f = 0.05 and 90 ° rotation}\label{fig:feat04}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{img/Features_2_015_90.png}
         \caption{Kernel with $\sigma$ = 2, f = 0.15 and 90 ° rotation}\label{fig:feat05}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.3\textwidth}
         \centering
         \includegraphics[width=\textwidth]{img/Features_4_015_0.png}
         \caption{Kernel with $\sigma$ = 4, f = 0.15 and 0 ° rotation}\label{fig:feat06}
     \end{subfigure}
        \caption{Result of convolving differently oriented gabor wavelets with an Landsat-8 image of Bremen}\label{fig:gaborExample}
    \end{figure}




\section{Comparable Definition of Urban Heat Islands}
    \subsection{Introduction}
    The definitions of \glspl{UHI} in the literature are varying slightly and do not take into account that, using remote sensing techniques most definitions do not allow easy comparison between different areas or times.
    %TODO add sources, maybe add examples? 
    The definition of the U.S.~EPA\cite{EPA2008} and the German Weather Service (DWD) both say it is an feature defined by increased temperature between the urbanized areas compared to the sourrounding. % TODO cite  
    Different studies analyzing \glspl{UHI} use difference referenece tempereatures.
    The first goal of this work is defining a systematic reproducable aproach to measure urban heat island intensity based on land usage.

    \subsection{Approach}
    To make the approach comparable previous work was done takeling the problem using a comparable definition for comparing \gls{SUHI} around the world using Sentinel images\cite{Sobrino2020}.
    The land cover classes indicating urban areas is identified and the urban area polygon is extended by buffer zones. 
    \begin{figure}
      \includesvg[width=\textwidth]{img/UrbanAreaBremen}
      \caption{Urban Area of Bremen, with buffer zones for Adjacent and Peri Urban Area}
    \end{figure}
    In~\cite{Sobrino2020} urban adjacent, future urban adjacent and peri-urban areas are defined.
    The used approach was adapted by removing the urban growth projection (the paper investigated \glspl{SUHI} in 2050).
    For \gls{LULC} Landsat 8/9 data was used combined with different \gls{ML} techniques for surface classification (see \cref{sec:classification}). % TODO 

    
    \subsubsection{Used Satellites}
    Using remote sensing data to detect and analyse \gls{SUHI} requires devices that detect thermal infrared radiation. 
    Satellites that are equipt with thermal infrared sensors that are able to detect upwelling emmission from the surface temperature within the $ 8 < \lambda < 12 \mu m $ range. 
    Commonly used instruments used for measureing UHIs are Landsat, MODIS, ASTER and Sentinel-3. 
    
    \subsection{Analysis}
%    \subsubsection{KMeans}\label{sec:kmeans}
%    Initially an unsupervised kmeans clustering algorithm was used for surface clasisfication, this was compared with. 
    
    \subsubsection{Classification }\label{sec:classification}
    For classifying surfaces a mixed approach of clustering and unsupervised machine learning was used. 
    As input, the multispectral data from Landsat where used.// 
    The multi band image was loaded and cut to match one of the used training areas (%TODO ref picture
). 
    Each band of the image was then processed using a Gabor Feature Extraction algorithm (s. \cref{sec:gabor}) with different parameter sets. 
    To judge results this was compared to the ESA CCI Land Use Data Set~\cite{landformclassicationusingfuzzykmeans2000} that was scaled up to the used image resolution . %TODO check if correct reference

    It was found, by variation of parameters, that the highest score was archived using 
%TODO try 
    rotations of the kernel, a kernel size of 
%TODO find 
    and (only circular kernel where used) with a $\lambda$ of 2 and 4. %TODO check 
    The frequencies of the sine wave where varied between 0.05 and 0.15. 


    \subsection{Conclusions}
    

\section{Impact of Climate Change on UHIs}
    \subsection{Introduction}
    The interaction between global and local climate is a complicated process that has multiple parameters, that are not completely understood nor are they all easily measurable. 
    In central Europe the climate is governed by seasonality typical for the northern hemisphere but al
    A climate tipping point (see~\cite{Lenton2008}) that could cause severe cooling in northern Europe is the breakdown of the Atlantic Thermohaline circulation\cite{Rahmstorf1999}.
    %TODO add a sentence for why
    But since the European climate is still under influence by the warm ocean currents, the temperatures in major European cities have increased at a similar pace then the global mean temperatures. 
    The cities covered by this study observed an average increase from 1990 to 2020 of %TODO 
    \textdegree C. 



%
    %:\\ 
    The hypothesis is that the rising temperatures observed over the past 30 years have increased heat island severity and size. 
    \subsection{Methodology}
    This was done by creating a time series of land surface temperatures and urban heat islands from 1990 to 2020 using Landsat 7 and Landsat 8 and 9 data. 
    The data was then correlated with air temperature data of local measurement stations. 


    \subsection{Analysis}
    \subsection{Conclusions}

\section{Impact of Land Use Land Cover Changes on UHIs}
    \subsection{Introduction}
    Soil properties impact the emissivity, thermal conductivity and heat capacity of an area.
    \subsubsection{Land cover classification}
    To differentiate between different surface types different approaches where used. 
    
    %The data foundation for the land cover classification where Landsat images of different areas, the dataset was multitemporal, multispectral images of the same area.
    %Each Dataset was then preprocessed with a gabor feature detection algorithm (see \cref{sec:gabor}) as 


    \subsection{Analysis}
    \subsection{Conclusions}

\section{Simulation and Modeling of UHIs}
    \subsection{Introduction}
    \subsection{Analysis}
    \subsection{Conclusions}

\section{Discussion}
    \subsection{Synthesis of Findings}
    \subsection{Implications}

\section{Conclusion}
    \subsection{Summary}
    \subsection{Future Work}

\section{Appendix}
    \subsection{Data}
    \subsection{Code}


\newpage
\printbibliography
\end{document}

%The surface classes where correlated with the %TODO check 
%Kataster data from Bremen as well as with OSM data. % todo do 
%
%Ziel Projekt teil: 
%- detection and error margins in UHI detection using remote sensing data 
%- data pipeline to create maps of UHI in areas 
%- surface classification based on remote sensing data correlated with 2nd and 3rd sources (kataster/ OSM) 
%- UHI "cores" identification 
%
%Master Fragestellungen: 
%- Correlation zw. UHI} und Pollutants? 
%https://pubs.acs.org/doi/epdf/10.1021/cr5006815 
%- Real time UHI size/occurrence prediction based on ground temperature stations (Bremen Airport) and pollutant levels? 
%- UHI classification in different environments, causes and effects, mitigation stategies? (e.g. Classification of Surface types, vegetation etc. within different climate zones (Phoenix, Bremen, Karlruhe, Essen, Something meditareiean, Afrika (coastal, arid, etc) /paper with adis abbeba)
%
%\subsection{}

%Of the different bands available from the used satellite data (Landsat7 and Landsat8), 
%the visible and near infrared bands where used for clustering. 
%The clustering was done using the simple k-means algorithm. 
%Different configuration where used %todo add pictures? 
%These where compared and referenced with ground truth data %todo add error and limitations refgerenec here 


