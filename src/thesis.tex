%FOR DESKTOP READING 
%\documentclass[12pt,a4paper, english,twoside]{scrartcl}
% FOR PRINTING 
\documentclass[12pt,a4paper, english,twoside]{scrartcl}
   
\input{res/settings.tex} % all the packets and such

% setup title 
\date{\today}
\title{Impact of Climate and Land Cover Change in Urban Heat Islands}
\author{%
  \begin{tabular}{ll}
    Supervisor: &Prof.\ Dr.\ Annette Ladstätter-Weißenmayer\\
    Secondary Supervisor: &Dr.\ Adrian Fessel\\ 
    Submission Date:\ &13.05.2024\\ % Deadline?
    \ &\ \\
    \ &\ \\
    \ &\ \\
    \ &\ \\
    Linus Andrae &  Hegelstraße 24 \\ 
    \ & 28201 Bremen  \\
    Matriculation Number: & 6015384 \hfill\\
  \end{tabular}
}%
%
\makeglossaries%
\setabbreviationstyle[acronym]{long-short}
% Acros
\newacronym{USGS} {USGS} {United States Geological Survey}
\newacronym{LST}  {LST}  {Land Surface Temperature}
\newacronym{ESA}  {ESA}  {European Space Agency}
\newacronym{LULC} {LU/LC} {Land Use/ Land Cover}
\newacronym{UHI}  {UHI}  {Urban Heat Island}
\newacronym{SUHI} {SUHI} {Surface Urban Heat Island}
\newacronym{NDVI} {NDVI} {Normalized Differential Vegetation Index}
\newacronym{HI}   {HI}   {Heat Index}
\newacronym{NIR}  {NIR}  {Near Infrared}
\newacronym{OSM}  {OSM}  {Open Street Map}
\newacronym{TOA}  {TOA}  {Top of Atmosphere}
\newacronym{VOC}  {VOC}  {Volatile Organic Compounds}
\newacronym{ML}   {ML}   {Machine Learning}
\newacronym{SVM}  {SVM}  {Support Vector Machine}
\newacronym{ECMWF}{ECMWF}{European Center for Medium-Range Weather Forecasts}
\newacronym{WBGT} {WBGT} {Wet Bulb Globe Temperature}
\newacronym{DWD}  {DWD}{Deutscher Wetter Dienst}
%
%
\newglossaryentry{WilMannWhitTe}%
{%
  name={Mann-Whitney-U-Test},
  description={A statistical test of a null hypothesis for non normal distributed data for two datasets}
}
\newglossaryentry{dilation}%
{%
  name={Dilation},
  text={dilation},
  description={An image processing operation that extends objects by adding pixel to the outside of an object}
}
\newglossaryentry{erosion}%
{%
  name={Erosion},
  text={erosion},
  description={An image processing operation that reduces the size of objects by removing pixels at the border of the object}
}
\newglossaryentry{AoI}%
{%
  name={Area Of Interest},
  description={A area that contains the city or structure to be investigated}
}
\newglossaryentry{lib}%
{%
  name={Library},
  description={a bundled collection of resources (e.g.\ algorithm) to be ease software development}
}
\newglossaryentry{sentinel3}%
{%
  name={Sentinel-3},
  description={A Pair of Satellites, that are part of the Copernicus constellation. Using 21 spectral channels with a resolution of 300~m per pixel}
}

\newglossaryentry{EPA}%
{%
  name={Environmental Protection Agency},
  description={U.S. Government organisation tasked with protection of the health of humans and the environments}
}
\newglossaryentry{MSE}%
{%
  name={Mean Squared Error},
  description={Algorithm to calculate the difference between two sets of data (see \cref{equ:mse})}
}
\newglossaryentry{SSIM}%
{%
  name={Structural Similarity Measure},
  description={Algorithm to calculate the similarity in Images \autocite{Wang2004}}
}
\newglossaryentry{IASC}%
{%
  name={Inter-Agency Standing Committee},
  description={The \textit{Inter-Agency Standing Committee} is an UN Organisation coordinating different bodies of the United Nations}
}
%

\begin{document}
  \input{title}
  \newpage
  \setcounter{page}{1}
  \pagenumbering{roman}
  \input{abstact}
  \newpage

  \tableofcontents
  \newpage
  \listoffigures
  %\newpage
  \listoftables
  \newpage
  % Abbreviations first
  %\printglossary[title=Abbreviations, type=abbreviations]
  \printglossary[title=Acronyms, type=acronym]
  \newpage
  %then the main glossary
  \printglossary%
% TODO REMOVE TODOS
\newpage 
\listoftodos%

\newpage
\onehalfspacing%
\input{acknowledgement.tex}
\setcounter{page}{1}
\pagenumbering{arabic}
\setcounter{figure}{0}
\section{Introduction}\label{sec:intro}
  The investigation of Urban Heat Islands are a very important topic in times of climate change and urbanization.\\
  Urban environments have been the interest of studies for a long time, but increases in frequency and intensity of extreme weather events and heat waves are significantly more likely to happen \autocite{Uhe2016}.
  These are expected to appear with intensities that were nearly impossible without the impact of climate change \autocite{Bador2016}.
  This is well understood and can be attributed to anthropogenic climate change on larger scales, but local effects and impact of climate change on a small scale is harder to simulate and understand.
  The major issue is that the missing impact of localized phenomena such as weather, terrain and urban climate are not covered by climate models, making prediction of extreme heat waves with high accuracy difficult~\autocite{VanOldenborgh2022}.
  Studying and understanding the local urban climate has a long history, including the understanding of \glspl{UHI} and impacts of urban atmospheric pollution on humans and the greater atmosphere. 
  Together with research the need for tools and data processing platforms are demanded by different organisations (such as the \gls{IASC}~\autocite{IFRC2022} and the \gls{EPA}~\autocite{FAS2024}) to prepare affected areas and organisations for heat mitigation in urban areas. 
 \subsection{An historical overview of urban heat research}
  The scientific investigation of the urban climate and the influence of human settlements and activity on the local atmosphere and temperature has been studied for more then 200 years.~%
  \cite{Howard1833}~investigated the climate of London in a study from 1819 to 1827 and a similar study was conducted in Paris in the 1850s by~\cite{renou1862differences}.~%
  The first mobile measurement campaigns around the topic of urban climate were conducted by~\cite{peppler1929auto} and~\cite{tollner1932untersuchungen} and investigated the spacial distribution of temperatures within urban areas  in the 1920s in Germany and Austria. 
  This type of measurement were repeated in multiple cities around the globe at the time.\\
  The term \gls{UHI} was coined in the 1960s in publications regarding case studies in London~\autocite{Chandler1961} and Montreal~\autocite{Oke1968}.
  During this time the influences and understanding of the interaction between the human industrial activity, the land change by urbanisation and industrialization and the influence of these factors on temperatures was investigated by numerous case studies using fixed or mobile weather stations.
  Health problems within industrial areas or incidents like the 1930 Meuse valley fog catastrophe, in which exhaust gases, including fluorine gas, combined with an inversion weather condition, forming a cloud over the area causing the death of at least 60 people~\autocite{Nemery2001}.

  The \textit{Great Smog of London} in 1952, a similar event lasting four days, causing 4000 direct deaths and between 10000 and 12000 deaths from consequences of the fog in the months after~\autocite{Bell2004}, triggered scientific interest in the interaction between human settlement, pollution and meteorological phenomena on human health and the environment. 
  The investigation of incidents like this using scientific methods shaped the idea of an man made urban climate.\\ \\ 
%
  To understand the urban meteorology in three dimensions the first use of balloons, helicopters and air planes to measure vertical temperature profiles were documented in the 1950s \autocite{Duckworth1954}.
  These studies focused on the atmospheric heat distribution over urban areas and resulted in the development of physical energy transport models for these atmospheric urban heat islands.
  These models required a deeper understanding of the surface properties and the temperature distribution within the urban area.\\ \\
  % 
  Then newly available remote sensing devices, such as infrared imagers, made it possible to observe the urban environment from above and detect temperature hot spots using airborne and satellite images.  \\
  %  
  First investigations regarding the feasibility of this approach were proposed in the late 70s (\cite{Watson1975},~\cite{Carlson1977} and~\cite{Block1978}) but the resolution of satellite images were insufficient for detailed investigations of \glspl{UHI}.\\
  A first study using satellite infrared imagery were conducted in 1978 using the NOAA 5 Satellite (with a spacial resolution of 1km~\autocite{Matson1978}).\\
  Multiple studies in the 70s and 80s used images taken from planes or helicopters to aid the investigation of smaller scale effects within the urban surface temperature distribution (e.g.~\cite{Landsberg1979},~\cite{ljungberg1980use} and~\cite{Foster1981}). \\
  With advances in satellite technology, the resolution and data availability increased significantly. 
  The Landsat program started in 1975 and with the launch of \textit{Landsat 4} in 1982 thermal infrared data of the whole planet were continuously provided. 
  The infrared resolution that allowed pixel sizes between 60 m (\textit{Landsat 7}) and 120 m (\textit{Landsat 4} and \textit{Landsat 5}), made investigations of smaller patterns within urban areas possible.\\
  Many different satellites have been launched since, closing gaps in spectral, spacial and temporal coverage, with different resolutions for different use cases. 
  Relevant for investigation of the urban climate are the ASTER and MODIS instruments on the Terra satellite, providing a high revisit time and are useful for land cover monitoring. 
  The ASTER instrument provides thermal data with high spacial resolution and a large dataset was created from ASTER data of the land surface properties (this dataset is used, among others, in the creation of the Land Surface Temperature product form the Landsat 8 and 9 satellites).
  The \glspl{ESA} Copernicus satellites provide high spacial resolution visible data (Sentinel-2) as well as surface temperature (Sentinel-3).\\
  %Other satellites, such as Terra with the ASTER instrument with visible and thermal images, Sentinel-2 providing visible resolution
  \begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{img/LandsatDataArchiveStatsProductsPerYear.png}
    \caption{Number of Landsat Products per year over time (as of Feb. 2024) by the \gls{USGS}~\autocite{landsatstats}\label{fig:landsatproductsovertime}}
  \end{figure}
  \noindent
  The increased revisit frequency of roughly two weeks made remote satellite data a more useful and widely used tool in the research on urban meteorology and urban heat islands.
  Over the past 30 years, the amount of available remote sensing data skyrocketed, Landsat 8 and 9 alone produced over 6 million images since the start of operation in 2013. \Cref{fig:landsatproductsovertime} shows the number of scenes taken by the Landsat satellites per year.
  The rise in availability on the one hand makes it easier for researchers and companies to use the data, requiring increased computing and storage availability, to manage the increased data amount.
  This offers the possibility of creating scientific studies covering a wide range of cities over time, using the same sensor and tools. \\ \\
  In~\cite{Sobrino2020} a methodology to compare \glspl{UHI} using \gls{sentinel3} images was proposed and a broad study of \glspl{UHI} severity in cities around the world was conducted.
  Over the past years the number of scientific papers investigating the issue from multiple angles increased significantly (ct.~\cite[P. 3]{Piracha2022b}).\\
  In conclusion, the advancement of remote sensing technology, particularly the availability of infrared imagers and satellite imagery, has revolutionized the study of \glspl{UHI}. 
  From the early investigations and roots of the field in meteorology and public health the research field expanded touching urban development, climate science, atmospheric chemistry and medicine as well as social sciences.\\
  The abundance of data provided by satellites like Landsat 8 and 9 now allows researchers to conduct long duration, high resolution studies.
  Analysing urban surface temperature distribution with unprecedented detail and accuracy.
  The increase in data availability has not only facilitated research on urban meteorology and heat islands but has also presented new challenges in terms of data management and analysis that require the creation of performative analysis software and methods to extract, monitor and analyse urban areas during change.\\
  Despite these challenges, the potential for conducting comprehensive studies across various cities using consistent sensor data and combining multiple sensor sources allows a deep understanding and continuous monitoring of the urban environment.
  %As demonstrated by studies such as the one conducted by \autocite{Sobrino2020} using Sentinel-3 images, the future of \gls{UHI} research holds promise for gaining deeper insights into the impacts of urbanization on local climate patterns worldwide.
  The coming years promise even more missions that can be used for detecting urban heat islands, with nearly daily coverage and higher spacial resolution (e.g.~ESAs LSTM mission with 50 m resolution and a 4 day revisit time~\cite{CEOS2024}). 
  Together with fusion approaches to combine different datasets to reduce error and increase spacial resolution (as done in e.g.~\cite{CampsValls2009}), monitoring services, heat warning systems and verification of implemented mitigations in cities by creating long term analysis of urban areas are about to become feasible.\\ \\ 
  The next step in advancing the comprehension of \glspl{UHI} involves gaining a deeper understanding of how various parameters contribute to the formation and intensity of \glspl{UHI}.
  With the wider adaption and interest in to the introduction of countermeasures to \glspl{UHI} and climate change resilience techniques in different cities, continuous monitoring of \glspl{UHI} and the urban climate is necessary to judge effectiveness of the taken countermeasures.
  To do this efficiently, statistical parameters and indices are crucial in order to assess the effectiveness of the mitigation strategies. 

 \subsection{Research Question}
  In this thesis, the impacts of land cover, land cover changes such as urbanisation, and rising average temperatures due to anthropogenic climate change on the \gls{UHI} phenomena are investigated.
  The specific questions posed are:
  \begin{enumerate}
    \item What definition can be used to define \glspl{UHI} comparably?\label{q1}
    \item What is the influence of \gls{LULC} change on the size of urban heat islands?\label{q2}
    \item How significant is the impact of urbanisation on \glspl{UHI}, both in terms of absolute and relative temperature changes?\label{q3}
    \item What is the effect of rising average temperatures on the \glspl{UHI} effect?\label{q4}
    \item What indices can be used or created to categorize and rate \gls{UHI} intensity?\label{q5}
    %\item Is it feasible to model \glspl{UHI} using the identified impacts of temperature and land use change?\label{q6}
  \end{enumerate}
  The first question tackles the problem that the \gls{UHI} phenomenon and its definition was refined over time. 
  For answering the question different types of \glspl{UHI} (see \cref{sec:uhi}) have to be distinguished and methods for measuring them found. 
  The goal is to find a definition that allows investigation and detection of \glspl{UHI} in a comparable way, to allow global measurement and comparison between cities and regions.\\ 
  The second and third question investigates the impact urbanisation and surface sealing on the intensity and size of urban heat islands. 
  This can help in urban planning and mitigation of effects of \glspl{UHI} in areas at risk.\\ 
  The goal of the fourth questions is to answer how much the rise of local temperature and the global mean temperatures due to climate change is affecting the intensity and size of \gls{UHI} effect in cities. 
  %The fifth question aims to provide a methodology and quantify if the \gls{UHI} effect can be modelled and predict the intensity when surface or air temperatures are given. 
  The fifth and last question shall answer what indices that are already given can be used to describe heat islands or if there is the need to create a new index for measuring intensity and human impact of \gls{UHI} effects within cities.

 \subsection{Methodology}\label{sec:methodology}
  To address the outlined research questions, multispectral satellite images are used to extract temperature and surface information. 
  This data is used and processed and urban areas are extracted. 
  The data is compared with measurements from ground based stations and statistical analysis is conducted to answer the questions posed above.

  \subsubsection{Data Sources}\label{ssec:datasources} 
    Multi-spectral visible and thermal infrared satellite images are used to measure and identify \glspl{SUHI} and analyse land surface temperature.
    The used satellite data product is described in \cref{sec:landsat}.
    The \gls{LULC} data is referenced against a \gls{LULC} product for validation.\\ 
    For air temperature data the data of weather stations within the area of interest are used, more details can be found in the \cref{sec:landcoverAnalysis} and \cref{sec:tempanalysis}. 

  \subsubsection{Procedure}\label{ssec:procedure} 
    The satellite data (s.~\cref{sec:landsat}) is selected using filters and manual selection to find cloud free images of the area of interest in the time period that was selected for analysis. 
    The dataset is downloaded and the area of interest is extracted to reduce the data footprint.
    This dataset is also used to classify the land cover to allow short term land cover analysis using machine learning algorithms for classification.
    For the further analysis a time series of \gls{LULC} is created for the city of Bremen. \\ 
    From the dataset a longitudinal analysis of \glspl{UHI} intensity over time is created.
    For the selected days where satellite cover is available, temperature data and other sources are used to create indices to measure heat stress and other parameters for assessing \glspl{UHI} intensity at different days.
    This data can then be used to create projections of \glspl{UHI} development based on the findings from \gls{SUHI} measurements and \gls{LULC} analysis.
    \Cref{sec:pipeline} explains the used processing steps in detail. 
  \subsection{Structure of the Thesis}\label{ssec:structure} 
    In the introduction as well as in \cref{sec:background}, previous work and an overview of the current understanding of the \gls{UHI} effect and research in this area is given. 
    %comparable definition
    \Cref{sec:definition} explains the used adaptation of the proposed methodology by~\cite{Sobrino2020} to create a definition of \glspl{SUHI} that is usable for comparing \glspl{UHI} in different cities.  
    \Cref{sec:LULC} explains how the measurements  and investigations of the impact of \gls{LULC} changes by build up where done.
    In \cref{sec:UHITempImp} the impact of changing temperatures an increase of extreme weather phenomena on the intensity and seasonal variety of \glspl{UHI} was investigated. 
    After these the \cref{sec:conclusion} combines the findings of the previous chapters, shows which further studies could investigate the \gls{UHI} phenomena and where this research could be improved. 
%
\newpage
\section{Background}\label{sec:background}
  \subsection{Urban Heat Islands}\label{sec:uhi}
    \Glsfirstplural{UHI} are areas with increased temperature in urban areas.
    Due to increase in global temperature as well as increased occurrence of extreme weather and longer periods of heat waves, this phenomenon will likely increase in intensity and will also occur in cities at higher latitudes (\cite{Sachindra2016},~\cite[p.~904]{Wilby2008}).
    \glspl{UHI} are a spacial phenomenon that occurs on different scales and intensities, this makes observation using remote sensing data a good and widely used approach~\autocite{Weng2003}.\\
    \glspl{UHI} are distinguished into surface and atmospheric \glspl{UHI} as discussed in the sections below. 
    The major background effect behind \glspl{UHI} is the change in energy transfer of solar radiation on urban surfaces. 
    \begin{figure}[htbp]
      \begin{center}
        \includegraphics[width=\textwidth]{img/radiationBudget.png}
      \end{center}
      \caption{The Urban Energy Budget~(, Reprinted from\cite[Fig. 7]{EPA2008}\label{fig:radiationbudget})}
    \end{figure}
    Compared to rural areas, the urban environment has additional reflective surfaces, creating additional energy transfer increasing the fraction of the incoming short wave solar radiation that is not reflected back towards the atmosphere \autocite[p.12]{EPA2008}. 
    Due to lower vegetation cover and higher sealed surfaces the amount of latent heat due to evaporation and transpiration is lower.
    The fraction of infrared radiation that is trapped within the urban area, especially if the sky view factor is low, is higher.\\ 
    An additional influx of thermal energy is anthropogenic emission from industrial production.
    \noindent 
    The guiding equation is the equilibrium of incoming solar radiation and the outgoing upwards radiation. 
    The incoming radiation ($R_n$) is matched by
  \begin{itemize}
    \item Latent heat transfer of evaporation and transpiration ($lE$)
    \item Sensible heat transfer due to wind and upwelling warm air ($H$), 
    \item Storage in surfaces ($S$)
    \item Metabolic conversion by photosynthesis ($M$)
  \end{itemize}
    This gives \cref{equ:radiation} with $R_n$ being positive and all other terms negative.

    \begin{equation}\label{equ:radiation}
      R_n + lE + H + S + M = 0
    \end{equation}
    \noindent 
    In rural areas, $lE$ and $M$ are bigger due to vegetation, while the $S$ term is larger due to surface properties mentioned above.
    $H$ depends strongly on urban morphology, so urban or rural areas can have higher sensible heat transfer rates.\\
   % \Cref{ssec:mitigation} shows possibilities to influence the amount of stored energy and influence the rate of evaporation within the urban area.
    % The underlying phenomenon is the change of the energy balance of the earth-atmosphere system and the urban energy sub system, where the external energy inflow is larger then the energy transfer out of the system for a given time\autocite[p. 19]{oke2002boundary}.
    % During a day, during daytime the insolation of any earth surface causes incident radiation is higher then the energy transport by long wave thermal emission and reflection. 
    % During the night the energy is radiated away from the heated surfaces and causes the surfaces to reduce temperature.
    % \begin{equation}

    % \end{equation}
   % 
    Since the phenomenon is known for a long time, mitigation strategies have been proposed to reduce the impact on well-being and intensity of the \glspl{UHI} and are touched upon in \cref{ssec:mitigation}.
    \Cref{sec:definition} will go into more detail of the definition of \glspl{UHI} for comparison within the scope of monitoring and remote sensing. 
    \subsubsection{Atmospheric Urban Heat Islands}\label{sec:at_uhi}
      Atmospheric \glspl{UHI} are sections with increased air temperatures within an urban area. 
      These are more dependent on weather and local topology and are in part caused by the slower cooling rate of build up land, responsible for \glspl{SUHI}.
      %Under certain conditions the increased temperature will form a hot air pocket, that will trap the head and reduce airflow from and to the area. \\
      The main factors in forming \glspl{UHI} is the thermal storage capacity of materials used in urban areas like concrete, asphalt and steel, that have a high heat capacity and heat up quickly during the day and emit the stored thermal energy as sensible heat with a delay (eg.~during the night~\autocite{Ramamurthy2014}).
      High surface sealing and lack of vegetation reduce surface water availability and diminish evaporation and the cooling effect of latent heat causing more thermal energy to be available as sensible heat. 
   % 
      Another factor is the heat produced by human activity such as industrial processes and combustion engines.
      As a consequence of higher temperatures, active cooling devices (such as air conditioners) are more frequently used for buildings and vehicles, converting electrical or chemical energy to thermal energy stored in the urban atmosphere. 
      The emitted thermal energy of these heat pumps further increases the surrounding temperature, reinforcing the effect.
      \\
      
    \subsubsection{Surface Urban Heat Islands}\label{sec:suhi}
       \glspl{SUHI} are areas of higher surface temperatures within urban areas compared to rural areas due to the materials used and heat from mobility, electrical appliances, heating and cooling as well as less vegetation and higher sealed surfaces that reduce surface water availability~\autocite[pp. 7--12]{EPA2008}. 
       The \glspl{SUHI} are a small scale phenomenon that has a high seasonal variability and is most intense in summer.
       \glspl{SUHI} are an important factor for the development of atmospheric \glspl{UHI} due to the following factors:
       \begin{itemize}
         \item Surface material radiates off the stored heat during the night, increasing urban air temperature
         \item Surface types are susceptible to regulatory influence allowing direct implementation of countermeasures by local government and direct action of citizens.
         \item Surface materials are one major factor in the development of \glspl{UHI} shown in \cref{sec:LULC}.
       \end{itemize}
       Since atmospheric \glspl{UHI} can not be directly observed using remote sensing data and are therefore not in focus of this work, the terms \gls{UHI} and \glspl{SUHI} are used interchangeably in later sections of this document. 
    \newpage
    \subsubsection{Air pollution and Urban Heat Islands}\label{ssec:airpollution}
      Air pollution has been a documented problem for the quality of life since the start of the industrialisation. 
      While in the 19th and first half of the 20th century the major problem came from unfiltered exhaust, burning coal and wood for heating and heavy industry.
      The major pollutants in urban areas in the 21st century come from car exhaust, industrial processes and by-products of industrial agriculture~(\cite{Leung2015} and~\cite{McDuffie2021}).
      Especially large urbanized areas are susceptible to air pollution due to increased concentration of combustion and industrial activity on a small area \autocite{Kanakidou2011}.
      One major pollutant with a significant health impact is tropospheric ozone, that is produced in larger quantities within environments with elevated temperature (see~\cite{Ebi2008}). \\
      \begin{wrapfigure}{r}{0.5\textwidth}
        \vspace{-1cm}
         \begin{center}
         \includegraphics[width=0.48\textwidth]{img/VOCsGraphs}
       \end{center}
       \caption{Temperature dependence of isoprene emission of 15 minute ($T_M$) and 15 day ($T_D$) mean temperature, with permission from~\cite{Guenther2000}}\label{fig:tempVOC}
      \end{wrapfigure}
      Ozone in the troposphere is mainly produced when (anthropogenic) NO\textsubscript{x} emissions from fossil fuel burning and \glspl{VOC} from anthropogenic or natural sources react with oxygen under UV influence in a photochemical reaction.
      The creation of ozone is dependent on UV intensity (and therefore insolation) and temperature, increasing between 2.2 and 3.2 ppbv/°C depending on NO\textsubscript{x} and \glspl{VOC} availability. 
      Recent studies found that reduction of NO\textsubscript{x} and \glspl{VOC} concentration, reduces O\textsubscript{3} temperature dependence (\cite{Otero2021}).
      Sources of \glspl{VOC} are mainly of natural origin~\autocite{Kansal2009}, anthropogenic sources are vapours and fumes from solvents and mainly originate from industrial processes while the main natural source of \glsps{VOC} are trees.
      Trees and other plants release VOCs like isoprene and terpenes as a protective mechanism against temperature stress and to protect from insects and pests. 
      The usefulness of these \glspl{VOC} for trees varies over the year.
      This gives the \gls{VOC} and the resulting O\textsubscript{3} emission a high seasonal variability (see \cref{fig:tempVOC}). 
      %
      The resulting tropospheric ozone, is a major health concern, it is directly toxic to humans and is shown to cause lung damage by oxidative stress in the lung lining tissue (see~\cite{Mudway2000}). 
      With rising global temperatures the number of days with temperatures causing heat stress in trees (e.g.\ with a temperature above 30~°C shown in \cref{fig:tempVOC}) has been increasing even at higher latitudes (~\cref{fig:ubaTemps} shows the German average of days exceeding 30 °C growing from 1950 from an average of 5 to 11.3 in 2023).
      \begin{figure}[htbp]
       \begin{center}
         \includegraphics[width=\textwidth]{img/ubaTemp.png}
       \end{center}
       \caption{Days with a maximum temperature of more then 30 °C in Germany~\autocite[Reprinted from]{Wilke2023}\label{fig:ubaTemps}}
      \end{figure}
      Due to the effect of \glspl{UHI} causing a further increase in temperature within urban areas, there is an expected increase of tropospheric ozone levels due to higher \glspl{VOC} emission from urban and sub-urban trees due. 
      This increases air pollution increases mortality and causes other negative health consequences within urban areas (shown in~\cite{Ebi2008}).\\ 
      Studies have shown, that reduction of \glspl{UHI} by urban greening reduces the amount of ozone by 5--8\% \autocite[p.209]{Fallmann2016}. 
      %
    \subsubsection{Mitigation techniques for Urban Heat Islands}\label{ssec:mitigation}
      There are multiple adverse effects and possible mitigation techniques for the reduction of \glspl{UHI} (e.g.~\cite{Nichol1994} and~\cite{Stewart2011}) some of which are natural phenomena. % list studies.  . 
      Advective cooling can be observed when the temperature gradient generates airflow from the cooler surrounding areas towards the hot areas within the city, cooling it down according to the second law of thermodynamics~\autocite{HaegerEugensson1999}. \\
      Urban areas with no close water body  and with low average wind speed are more likely to be affected by urban heat islands~\autocite{Ramamurthy2017}. 
      Since water reduces the severity of heating, due to sea breezes as well as latent heat transport and acts as a thermal capacity, dampening heating effects. 
      Higher temperatures due to \glspl{UHI} cause stress to animals and humans, increasing health risks due to heat stroke and increased surface level ozone concentration~(see~\cite{Santamouris2020}).\\
      The attempt to reduce urban heat build-up and the associated heat related health problems in cities is older than scientific work on this field of study. 
      In hot areas around the globe different methods were used to create spaces with cooler temperatures for rest and work. 
      All over the Mediterranean, houses are painted white to increase albedo of roof surfaces, decreasing heat build-up. 
      In newer studies, this traditional painting pattern has shown to be an efficient counter to high solar intensities \autocite{Fayad2021}.
      % Many cultures use passive cooling  roofs TODO find paper also passive ventilation and such 
      Another method of larger scale cooling is the increase of vegetation to increase latent heat transport and water availability.
      Two basic physical principles make water well suited for cooling and energy transfer.
      Water has a latent heat of vaporization of $2440 kJ\cdot \text{kg}^{-1} \text{ at } 25$ \textdegree\ C and the capacity of water vapor in higher temperature air is increasing exponentially.
      Saturation vapor concentration increases from $\approx17.5 \text{g}\cdot \text{m}^{-3}$ at 20 \textdegree\ C  to $\approx 52 \text{g}\cdot \text{m}^{-3}$ at 40 \textdegree\ C.
      This means that, given surface water availability, high amounts of water can be vaporized and will carry away higher amounts of thermal energy in higher temperature condition.
      Reducing temperature in the surrounding area. 
      Active evaporative cooling was used and studied in arid climates over the past decades, showing effective at low air humidity providing 10 to 15 K cooling during high heat hours~\autocite{Vanos2022}.
      %
      While high relative humidity, at high temperatures, has significant health risks (see \cref{sec:heatIndex}), evaporation reduces temperature.
      \Cite{Pontes2022} developed a comfort zone, based on the Heat Index, founded on field measurements and previous research. 
      This could be used to find an optimum between increase in relative humidity and air temperature e.g.\ by limiting the use of moisture based active cooling or adding evaporation control covers as already shown effective in areas with high insolation~\cite{Ghazvinian2021}.\\
      Green roof concepts, green facades, parks or street trees all show effective in reducing temperatures within the urban environment (see~\cite{Ramamurthy2014, Feyisa2014, Dimoudi2003, Gartland2008}).
      The study by~\cite{Fallmann2016} mentioned in \cref{ssec:airpollution} also showed that urban greening has a more beneficial effect compared to high reflective surfaces. 
      Due to the increase in back scattering of high energy radiation of reflective surfaces, ozone is created during high insolation, providing additional health risks.
      The same simulation showed that urban greening can limit boundary layer mixing due to reduced thermal updraft caused by lower turbulent kinetic energy, increasing pollution levels at street level.
      This problem can be solved by employment of established methods for reduction in urban pollution, e.g.\ increase of public transport and regulation or taxation for high pollution vehicles and industries. \\
      Adding water bodies inside the city as well as ``sponge-city''-concepts are also promising approaches to mitigate heat islands (\cite{He2019}).
      Increasing the water available can also be archived using different, less sealed surfaces, such as grass pavers or permeable pavements, that cause less run-off \autocite[p. 7]{EPA2008}.
      % 
    \subsubsection{Landsat 8 \& 9 Dataset}\label{sec:landsat}
      \begin{figure}[htbp]
       \begin{center}
         \includegraphics[width=\textwidth]{img/LandsatSpectralBands.png}
       \end{center}
       \caption{Landsat 8 and 9 instrument spectral bands (second to last row) compared to other Landsat missions\autocite{USGSWebsite}\label{fig:lsspectral}}
      \end{figure}
      \noindent
      Using remote sensing data to detect and analyse \gls{SUHI} requires devices that are able to detect thermal infrared radiation. 
      Satellites that are equipped with thermal infrared sensors, are able to detect upwelling emission from the surface within the $ 8\mu\ m < \lambda < 12\ \mu m $ range. 
      Instruments that were previously used for measuring \glspl{UHI} are Landsat, MODIS, ASTER and Sentinel-3. 
      In the following steps data from the Landsat 8 and Landsat 9 satellites were used. 
      Landsat 8 and Landsat 9 both have a TIRS (Thermal Infrared Sensor) and an OLI (Operational Lands Imager) instrument on board that measure in two and nine bands respectively.
      Since the start of Landsat 9 the availability of scenes increased and the shorter revisit times allow a denser mapping and reduced risk of cloud cover. \\ 
      The OLI covers a wavelength of 0.43 $\mu m$ to 1.83 $\mu m$ separated into 9 bands with a resolution of 30 m per pixel (see \cref{fig:lsspectral}). 
      For the calculation of thermal infrared emission of the Earth's surface the TIRS instrument contains two bands within the thermal infrared covering wavelength between 10.6 $\mu m$ and 12.51 $\mu m$ with a resolution of 100 m.
      Both satellites have a revisit time of 14 days. 
  \subsection{Land Surface Temperature}\label{ssec:lst}
    Land surface temperature is the temperature at which an object emits infrared radiation according to plank's law~\autocite{Liang2020}.
    Using remote sensing methods this quantity can not be directly observed since the satellite is observing \gls{TOA} brightness temperature.
    This temperature can be transformed to a \gls{LST} using atmospheric correction and correction for the emissivity of the ground.
    The conversion factor is data source dependent and can be found in \cref{sec:lstcalc}.
  \subsection{Air Temperature}\label{ssec:airtemperature}
    Urban heat islands that directly impact human health are the atmospheric \glspl{UHI} in the urban canopy layer. 
    These are defined by the air temperature from street level up to roof height. 
    \begin{figure}[htbp]
       \begin{center}
         \includegraphics[width=\textwidth]{img/CanopyLayer.png}
       \end{center}
       \caption{Overview of the Urban Atmosphere \autocite[Figure 1]{Fabrizi2010}\label{fig:canopeylayer}}
     \end{figure}
    The air temperature within the urban area is warmed differently from the air temperature outside the urban area, due to higher thermal mass that buildings and sealed surfaces have and lower latent heat transport.
    %
    During the day the air temperature is lower than the surface temperature~\autocite{EPA2008}, during the night the hot surfaces radiate off the energy heating the surrounding air.\\
    %
    There are multiple additional factors impacting urban air temperature. 
    Combustion from traffic and industrial processes produce heat as a by-product heating the surrounding air. 
    HVAC systems also produce heat, when cooling buildings. 
    This further increases the air temperature, increasing cooling need within the urban area, creating a positive feedback loop. 
    \input{ndvi}
    \subsubsection{Heat Index}\label{sec:heatIndex}
    The \gls{HI} is a temperature index that takes sultriness into account and rates the impact of temperature and air humidity of the human body. 
    The output of this temperature scale (given in °C) is the apparent temperature, depending on relative air humidity. 
    The defined range is between 20 °C and 50°C dry bulb temperature and up to 90\% relative humidity~\autocite[p. 862]{Steadman1979}. 
    The \gls{HI} is based on a model human and takes wind chill and clothing into account, to produce a apparent temperature of the model human. 
    The \gls{HI} can be used as a good reference for non-extreme conditions. 
    Its biggest downside is the missing account for direct insolation on body temperature and comfort.
    \Cite{Schoen2005} created an polynomial approximation for the heat index table developed by Steadman \autocite{Steadman1979}, with $\pm 0.7$ \textdegree\ C for temperatures above 27 degrees that was used for rating heat island severity.

    \begin{equation}
      HI = c_1 + c_2 T + c_3 R + c_4 T R + c_5 T^2 + c_6 R^2 + c_7 T^2 R + c_8 T R^2 + c_9 T^2 R^2
    \end{equation}
    with T being the wet bulb globe temperature and R being the relative humidity. 
    $c_1$ to $c_9$ are factors for correction depending on temperature, wind chill and where taken from~\cite{Cassano}.
    For extreme conditions the \gls{HI} shows an underestimation during heat waves \autocite{Romps2022}, limiting the usefulness for these scenarios.
    \subsection{Wet Bulb Globe Temperature}\label{sec:WBGT}
     To account the impact of insolation on the human body and the effect on heat stress exacerbated on the human body when high heat and insolation are present at the same time, the Wet Bulb Globe Temperature was developed. 
     Working under heat stress poses a serious health issue, for this the \gls{WBGT} was defined as EN ISO 7243:2017 (\cite{Iso7243_2017}) as work place safety standard, calculating the thermal load on the human body.
     Heat exchange between the human body and the environment is dominated by evaporation of secreted sweat.
     The efficiency of this process is determined by the vapor pressure, that is influenced by the temperature and humidity difference.
     The simpler \gls{HI} is a way of calculating this impact while not taking radiant heat into account, the \gls{WBGT} does incorporate this effect into this calculation.
     It was specially developed to help create safety for workers that work long hours outside with little or no shade, like construction or agricultural workers or soldiers.
\newpage
\section{Image Processing}\label{sec:imgProcessing}
    Using remote sensing data for scientific purposes requires a 
    \begin{itemize} 
      \item[a] systematic
      \item[b] reproducible and 
      \item[c] verifiable 
    \end{itemize}%
    way of extracting patterns and information from the available dataset.\\
    The field of image processing and machine learning has developed a wide range of tools that are used in many different fields over the past decades. 
    \subsection{Machine Learning}\label{sec:ml}
      The term machine learning describes a sub-set of artificial intelligence research, focusing on algorithms that use statistical models to find correlations using different weights to approximate data.
      Machine Learning encompasses a wide range of techniques, including supervised, unsupervised and reinforcement learning, as well as more specialized topics such as deep learning and symbolic regression\autocite{Rodrigues2023}. 
      In the context of remote sensing, machine learning methods have been utilized for tasks such as classification, biomass and soil moisture retrievals, and crop growth monitoring.
      Flexibility and comparably lower computational requirements of machine learning methods allow processing of large amounts of high-dimensional data and handle non-linear problems, enabling efficient analysis of remote sensing data \autocite{Maxwell2018}.\\
      Physics-Informed Machine Learning allows integration of base truth to circumvent ``hallucinations'' or false results, that can occur in other \gls{ML} techniques and aims to guide machine learning models towards solutions that are physically plausible.
      Examples of applications of machine learning in physics include system identification, control, and analysis, as well as the development of physics-informed digital twins. 
      \gls{ML}, offering powerful tools for data analysis, modelling and gaining deeper understanding of remote sensing and atmospheric research data.
      These approximations can be stored and be used to detect the same features within new but similar data.
      For this analysis the k-means algorithm was used. 
      In the next sections the image processing steps are described from a technical perspective and the underlying mathematical frameworks are discussed.
    \subsection{Data Processing Pipeline}\label{sec:pipeline}
      An image or data processing pipeline is a chained list of processing steps, allowing to feed different data through the same algorithm. 
      Many different data processing and machine learning \glslowercase{lib} use these to allow flexibility and modularity of the steps in data processing (e.g.\ the used Scikit-Learn~\autocite{scikit-learn}, Keras~\autocite{keras} or Gluon~\autocite{gluon}). 
      The data processing was done using a \textit{scikit-learn} pipeline for data analysis as well as multiple other \glslowercase{lib} listed in \cref{sec:code}.
      In \cref{fig:pipeline} the overview of the different steps within the data processing can be seen.
      \begin{figure}[!htbp]
         \begin{subfigure}[b]{0.40\textwidth}
           \input{pipelinetrain.tikz.tex}
           \subcaption{Processing pipeline for training the model}\label{fig:pipelineTraining}
         \end{subfigure}
         \begin{subfigure}[b]{0.40\textwidth}
           \input{pipelinetrained.tikz.tex}
           \subcaption{Data Processing pipeline with the trained Model}\label{fig:pipelineTrained}
         \end{subfigure}
         \caption{The image processing overview\label{fig:pipeline}}
       \end{figure}
       %
       \newpage
    \subsection{Gabor Feature Detection}\label{sec:gabor}
      \begin{wrapfigure}{r}{0.40\textwidth}
      \vspace{-1cm}
       \begin{center}
         \includegraphics[width=0.38\textwidth]{img/KLarge.png}
       \end{center}
       \caption{Example kernel with 26$\times$26 pixel kernel size}\label{fig:largeKernel}
      \end{wrapfigure}
      The Gabor filter is a linear filter using a convolution of an image with a wavelet created by rotating a sine modulated Gaussian. 
      This kernel type is also called the \textit{gabor wavelet}.
      \Cref{fig:largeKernel} shows an example of a single Gabor filter kernel.
      In image processing, this algorithm is used as a feature extraction algorithm, to extract and analyse texture and structures of different sizes within the image~\autocite{Cerdan1993}. 
      By rotating the kernel and changing the frequency, different textures are extracted from the image.\\
      %
      Mathematically the Gabor-filter is defined by
      \begin{equation}
        g(x,y; \lambda, \theta, \phi, \sigma, \gamma) = \exp \left(- \frac{x'^2 + \gamma^2\cdot y'^2}{2\sigma^2}\right) \cdot \exp \left[i \left(2\pi\frac{x}{\lambda} + \phi \right)\right] 
      \end{equation}
      With $ x' = x \cos(\phi) + y \sin(\phi)~\text{and}~y' = -x \sin(\phi) + y \cos(\phi)$.\\ 
      The \textbf{x} and \textbf{y} parameter determine the kernel size, this parameter should be chosen based on the image size and expected structure length.\\
      $\boldsymbol{\gamma}$ is the aspect ratio of the kernel, with $\gamma = 1$ the kernel is round, for smaller $\gamma$ the kernel becomes a more eccentric ellipse.\\
        $\boldsymbol{\phi}$ is the angle of phase shift of the sine component of the kernel. \\
        $\boldsymbol{\theta}$ is the angle of rotation of the kernel, detecting differently oriented features.\\
        $\boldsymbol{\lambda}$ is the wavelength of the sine wave. \\
        $\boldsymbol{\sigma}$ is the standard deviation of the Gaussian distribution.\\ \\
      \noindent
      To detect different structures of different scales within the image, a filter bank can be created by combining multiple filters and varying $\phi$, $\sigma$ and $\theta$.\\
      After the convolution of the image with the filter bank, the resulting set of detected features can be used as an input into different algorithms.
      \Cref{fig:gaborExample} shows the binary output of different kernel sizes and rotations on a satellite image of Bremen. 
      It can be seen that the different structures such as fields (seen in \cref{fig:feat02} and \cref{fig:feat05}) or larger structures and water bodies (seen in \cref{fig:feat01} and \cref{fig:feat03}) are extracted from the image.
      The output of the filter is an tensor that contains a binary image sized matrix per filter. 
      Each layer provides meta information for each pixel, if it is part of a larger scale texture or pattern. 
      This meta information is used to add additional features for the surface classification (\cref{sec:classification}) using k-means %(in training) and 
      to allow better classification.%using the random forest model.
      \begin{figure}[!htbp]
         \centering
       \begin{subfigure}[b]{0.45\textwidth}
           \centering
           \includegraphics[width=\textwidth]{img/Features_2_005_0.png}
           \subcaption{Kernel with $\sigma$ = 2, f = 0.05 and 0 ° rotation}\label{fig:feat01}
       \end{subfigure}
       \hfill
       \begin{subfigure}[b]{0.45\textwidth}
           \centering
           \includegraphics[width=\textwidth]{img/Features_2_015_0.png}
           \subcaption{Kernel with $\sigma$ = 2, f = 0.15 and 0 ° rotation}\label{fig:feat02}
       \end{subfigure}

       \begin{subfigure}[b]{0.45\textwidth}
           \centering
           \includegraphics[width=\textwidth]{img/Features_4_005_0.png}
           \subcaption{Kernel with $\sigma$ = 4, f = 0.05 and 0 ° rotation}\label{fig:feat03}
       \end{subfigure}
       \hfill
       \begin{subfigure}[b]{0.45\textwidth}
           \centering
           \includegraphics[width=\textwidth]{img/Features_2_005_90.png}
           \subcaption{Kernel with $\sigma$ = 2, f = 0.05 and 90 ° rotation}\label{fig:feat04}
       \end{subfigure}

       \begin{subfigure}[b]{0.45\textwidth}
           \centering
           \includegraphics[width=\textwidth]{img/Features_2_015_90.png}
           \subcaption{Kernel with $\sigma$ = 2, f = 0.15 and 90 ° rotation}\label{fig:feat05}
       \end{subfigure}
       \hfill
       \begin{subfigure}[b]{0.45\textwidth}
           \centering
           \includegraphics[width=\textwidth]{img/Features_4_015_0.png}
           \subcaption{Kernel with $\sigma$ = 4, f = 0.15 and 0 ° rotation}\label{fig:feat06}
       \end{subfigure}
          \caption{Result of convolving differently oriented Gabor wavelets with an Landsat-8 image of Bremen}\label{fig:gaborExample}
      \end{figure}
      \newpage
      \subsection{K-Means Clustering}\label{sec:kmeans}
    K-means clustering is an unsupervised machine learning algorithm that is used to partition $n$ observations into $k$ clusters. 
    Each observation belongs to the cluster with the nearest mean, serving as a prototype of the cluster. 
    This method has many applications in data mining, image processing and pattern recognition.\\
    The algorithm consists of three steps:
    \begin{enumerate}
        \item \textbf{Initialization}: Choose $k$ initial centroids from the data points.
        \item \textbf{Assignment}: Assign each data point to the nearest centroid, forming $k$ clusters.
        \item \textbf{Update}: Recalculate the centroids as the mean of all data points in the cluster. 
    \end{enumerate}
    This process is repeated until a maximum number of iterations or minimal changes in centroids is reached~\autocite{Sinaga2020}.\\ 
    There are multiple algorithmic implementations of K-Means, the specific algorithm used for classification used the Lloyd-Algorithm.
    Mathematically a set of observations $(x_1, x_2, \ldots, x_n)$, where each observation is a $d$-dimensional real vector.
    K-means clustering aims to partition the $n$ observations into $k$ ($\leq n$) sets $S = \{S_1, S_2, \ldots, S_k\}$ so as to minimize the within-cluster sum of squares. \\
    The objective is to find:
    \begin{equation}
        arg\,\min{S} = \sum_{i=1}^{k} \sum_{x \in S_i} \| x - \mu_i \|^2
    \end{equation}
    where $\mu_i$ is the mean of points in $S_i$.
    %
    The k-means clustering algorithm has been successfully used for surface classification using the feature enriched multi band satellite data~\autocite[e.g.]{Burrough2000}.
    \Cref{fig:kmeansclusters} shows the result of clustering land surface types. 
    %
    The pre-trained model is stored to disk and can be used to classify similar images again. 
    Since the class labels are not consistently applied, the labels need to be reassigned to the correct cluster.
    For this the cluster-centres from the trained k-means are saved as a array of $n$-tuples for each class, where $n$ is the number of features used for training.
    \newpage
    \subsubsection{Label Reassignment}\label{sec:labelassignment}
    The distance from the cluster centres of the initial training dataset and the centres of the newly classified data is calculated. 
    To get consistent mapping of class names to classification id, the minimal distance is not sufficient since an assignment of multiple classes to one original class has to be minimal. 
    To mitigate this issue the \textit{Hungarian Algorithm} is used, minimizing an overlying metric and creating a bijective assignment. 
    The distances are then minimized using the sum of distances of all cluster centres as optimization metric.
      \begin{equation}
        \min = \sum_{i}\sum_{j} C_{i,j}X_{i,j}
      \end{equation}
    This ensures that the minimum distance is used and an optimal reassignment takes place, even if cluster centres shift between images.
\newpage
\section{Comparable Definition of Urban Heat Islands}\label{sec:definition}
    \subsection{Introduction}
      The definitions of \glspl{SUHI} in literature are varying slightly and do not take into account that most definitions do not allow easy comparison between different areas or times.
      Local studies often use a single reference measurement station and use the absolute temperature difference as a measure of intensity.
      Others use the surface temperature of surrounding rural areas like forests as a reference.
      The definition of the U.S.~EPA (~\cite{EPA2008}) and the German Weather Service (\gls{DWD}) both define \gls{SUHI} as an area of increased temperature between the urbanized areas compared to the surrounding.\\ 
      Different studies analysing \glspl{UHI} use different reference temperatures.
      The first goal of this work is defining a systematic reproducible approach to measure \gls{UHI} intensity.
    \subsection{Approach}
      As a starting point the method of~\cite{Sobrino2020} was adapted, where \gls{SUHI} where compared in different cities around the world using Sentinel-3 images. 
      For each city a buffer zone was calculated around the city border, using the average temperatures of the different areas as a comparison point.
      This was then used to identify and measure the intensity of heat islands within the city area.\\ 
      This work uses the same basic approach but Landsat 8/9 data was used. 
      In~\cite{Sobrino2020} urban adjacent, future urban adjacent and peri-urban areas are defined as buffers.
      These where adapted by removing the urban growth projection (since the scope of the paper was the investigation of \glspl{SUHI} in 2050 that does not match the goal for this work).
      The urban area is identified by detecting land cover classes indicating a larger area of build up classes. 
      These areas are then converted into a polygon that is extended by buffer zones as shown in \cref{fig:bufferedBremen}.
      The classification was done using the same dataset.
      Larger urban areas are removed from within the reference temperature area.
      For the processing of the images and techniques for surface classification see \cref{sec:classification}. 
      Additionally, an approach is discussed where the relative (statistical) intensity is used compared to the absolute temperature difference to compensate for seasonal temperature spread within certain areas.
      \newpage
    \subsection{Definition of Urban Heat Islands}\label{ssec:definition}
      The following \gls{UHI} definition is proposed and used throughout this document.\\
      \\
      \noindent\fcolorbox{gray!30}{gray!40}{%
      \parbox{\linewidth}{%
        \vspace{0.2cm}
        An \gls{SUHI} is an area with increased surface temperature within an urban space. 
        It is defined as having a temperature at least 3 standard deviations above the average temperature of the adjacent rural buffer zone. 
        The rural buffer zone measurement is corrected for temperature influence of larger settlements.
       }
      }\\ \\
      %
      For comparability a statistical metric is used, since the absolute intensity as well as the daily temperature spread varies with the seasons and is easily altered by water bodies or other thermal masses in the image.\\ 
      The proposed threshold of at least three standard deviations above the average temperature was chosen since this gave consistent results over the seasons. \\
      The reference measurement is calculated using the surface temperature of the peri-urban buffer zone and removing all larger urban areas within it. 
      The removal will get rid of the temperature influence of other cities or larger industrial sides close to the area of interest.
      The mean temperature and variation within the peri-urban area is then calculated and used as reference.
      % Assuming that temperature is normal distributed the temperature should lie outside of the 95%ile 
      Depending on the season the temperature distribution will vary.
      Due to the definition using the standard deviation, the detection of \glspl{UHI} is coupled to the range of temperatures observed within the image. 
      During processing single outlier areas as well as clouds, cloud shadows are removed.
      Holes within the urban area are closed, this allows to include parks and other urban green areas to be processed and only includes larger areas of elevated temperatures as urban heat islands. 
      This will increase robustness of \gls{UHI} detection to reduce the influence of single hot surfaces (such as solar panels or industrial tanks) during detection.

    \subsubsection{Urban Buffer Zones}\label{sec:urbanBufferzone}
      To generate the different temperature statistics, buffer zones must be created.
      This is done by defining multiple areas using \cref{equ:areas}.
      \begin{equation}\label{equ:areas}
        \begin{split}
          W_U = & \frac{A_U^{\frac{1}{2}}}{4} \\
          W_P = & \frac{6\cdot A_U^{(\frac{1}{2}-W_U)}}{4}
        \end{split}
      \end{equation}
      Where $A_U$ is the urban area, extracted from the classification (see \cref{sec:urbanAreaExtraction}), $W_U$ is the suburban buffer zone and $W_P$ the peri-urban area.
      These definitions were used in~\cite{Sobrino2020} and were initially developed in the 90s for modelling urban development and are used in different areas of urban planning and analysis~\autocite[see]{AlkanBala2014}.
      These models follow the idea that cities have an influence space surrounding them and grow in all directions if not obstructed by borders or natural barriers. 
      The practical implementation used the results of the classification for urban area detection and buffer zone creation and is described in more details in \cref{sec:urbanAreaExtraction}. \\
      The heat island is then defined as area that is more then $3\sigma$ above the mean temperature of the surrounding area $W_P$, while the surrounding area is defined as a fixed buffer based on the size of the urban area and clean the area of larger settlements. 
    \subsection{Conclusions}
    The definition of \glspl{UHI} using reference regions and a statistical threshold for identifying areas is a methodology that has multiple advantages compared to using absolute values and single reference points. 
    The impact of seasonal and geographic variations in temperature spread as well as weather and other metereological effects are reduced, since the peri urban area has a mixed composition. 

\newpage
\section{Impact of Land Cover Changes on Urban Heat Islands}\label{sec:LULC}
    \subsection{Introduction}
      One of the key factors influencing the intensity and distribution of \glspl{UHI} is land cover change.
      Change in \gls{LULC} is primarily driven by urbanization and associated human activities.
      Soil and surface properties impact the emissivity, thermal conductivity and heat capacity of an area.
      Increases in the sealed surface fraction reduces surface water availability (see \cref{sec:uhi}).
      This is changing the energy flow, increasing the heat build-up within the urban area.
      \\    
      This section examines the relationship between land cover change and \glspl{UHI} effects using \gls{LULC} detection based on the previously classified Landsat images.
      The first part of this section begins with an overview of how land cover changes influence heat build-up within the urban environment. 
      Followed by how \gls{LULC} can be detected using Landsat data and how surface classification was done within this work. 
      \\
      This section then goes into detail how the classification of land cover was conducted using Landsat 8 and 9 images, the analysis of spatial and temporal patterns of \glspl{UHI} in relation to the detected land cover classes follows.
      To answer the question \labelcref{q2} of the influence of land cover change on intensity and size of \glspl{UHI}, statistical analysis is conducted on the \glspl{UHI} within the area of Bremen. \\
    \newpage
    \subsection{Impact of Land Cover/ Surface Type on Heat Build-up}
      %\begin{wrapfigure}{r}{0.40\textwidth}
      %  \vspace{-0.7cm}
      %  \centering
      %  \begin{subfigure}[b]{0.38\textwidth}
      %    \includegraphics[width=\textwidth]{img/Features_swir10.png}
      %    \subcaption{Convolution of SWIR Band and kernel 10}
      %  \end{subfigure}

      %  \begin{subfigure}[b]{0.38\textwidth}
      %    \includegraphics[width=\textwidth]{img/Features_blue3.png}
      %    \subcaption{Convolution of blue band and kernel 3}
      %  \end{subfigure}

      %  \begin{subfigure}[b]{0.38\textwidth}
      %    \includegraphics[width=\textwidth]{img/Features_nir_6.png}
      %    \subcaption{Convolution of NIR Band and kernel 6}
      %  \end{subfigure}
      % \caption{Examples of the convolution of different bands and Gabor filters\label{fig:gaborresults}}
      % \vspace{-2.1cm}
      %\end{wrapfigure} 
      The change of the urban surface properties is one of the major factors causing \glspl{SUHI}.  
      Multiple studies have shown that land cover has a significant impact on land surface temperature and \glspl{UHI} (e.g.~\cite{Karakus2019},~\cite{Weng2004} and~\cite{Stewart2011}). 
      This is mainly caused by the physical thermal properties of the different materials found in the different land cover classes. 
      Areas with urban characteristics contain higher amounts of metal, stone and concrete, materials with a high thermal mass combined with a higher absorption at short wavelengths (dependent on surface coatings).  
      %Water and Vegetation have a high emissivity with > 0.9 compared to 0.2 -0.9 of metal, brick, concrete and bare soil. 
      Build up surfaces have lower water availability for evaporation and thus more heat is heating up the material itself.
      Forests and other vegetated areas are permanently cooled by evaporative cooling and transpiration of trees, increasing vapor content and heat capacity of the air.
    \subsubsection{Classification }\label{sec:classification}
      The methodology employed for land cover classification involved the multi-step process utilizing satellite imagery, feature enhancement and machine learning techniques shown in \cref{fig:pipeline} and described in \cref{sec:pipeline}.
      The primary data source for classification were 8-band Landsat images, which provided a comprehensive spectral view of the area to be classified.
      To augment the dataset and enhance the classification accuracy, Gabor filtering (see \cref{sec:gabor}) was applied to the Landsat images.
      As input, the Gabor filtered multispectral data of satellite images from two dates were used.
      The multi band image was loaded and cut to match the study area and reduce processing time by reducing data size.  \\
      The analysis used the following parameters: \\
      % Classification: 
      The Gabor filter used for feature engineering was varied using different $\sigma$, $\theta$ and $f$ values.
      Due to computational restrictions the number of rotations ($\theta$) was limited to 5, a value of 4 yielded in best results. 
      For ease of variation the $\sigma_x$ value was varied while the $\sigma_y = \frac{\sigma_x}{2}$, giving a 2:1 kernel ratio (shown in \cref{fig:gaborbank}).\\
      For $\sigma_x > 2$ the classification degraded showing stripes very large patterns were detected, a value of $\sigma_x = 1$ resulted in a kernel size of 7 $\times$ 7 pixel and good results.
      The usable frequencies are limited by the size of the kernel and the image resolution shown in \cref{fig:gaborbank}.
      Due to the low resolution, a large kernel size would detect features that are repeated with a features size in the range of 200 m that do not occur in large quantities in urban areas. 
      Larger kernel sizes with higher frequencies would increase detection capability for images with higher resolution. 
    \Cref{fig:gaborbank} shows the used kernels for classification.
     %Due to the low resolution of 30 m per pixel high frequencies where not abl

    \begin{figure}[!htbp]
      \centering
      \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{img/K0.png}
        \subcaption{Kernel 1}
      \end{subfigure}
      \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{img/K1.png}
        \subcaption{Kernel 2}
      \end{subfigure}
      \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{img/K2.png}
        \subcaption{Kernel 3}
      \end{subfigure}

        \begin{subfigure}[b]{0.3\textwidth}
          \includegraphics[width=\textwidth]{img/K3.png}
          \subcaption{Kernel 4}
        \end{subfigure}
        \begin{subfigure}[b]{0.3\textwidth}
          \includegraphics[width=\textwidth]{img/K4.png}
          \subcaption{Kernel 5}
        \end{subfigure}
        \begin{subfigure}[b]{0.3\textwidth}
          \includegraphics[width=\textwidth]{img/K5.png}
          \subcaption{Kernel 6}
        \end{subfigure}

        \begin{subfigure}[b]{0.3\textwidth}
          \includegraphics[width=\textwidth]{img/K6.png}
          \subcaption{Kernel 7}
        \end{subfigure}
        \begin{subfigure}[b]{0.3\textwidth}
          \includegraphics[width=\textwidth]{img/K7.png}
          \subcaption{Kernel 8}
        \end{subfigure}
        \begin{subfigure}[b]{0.3\textwidth}
          \includegraphics[width=\textwidth]{img/K8.png}
          \subcaption{Kernel 9}
        \end{subfigure}


      \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{img/K9.png}
        \subcaption{Kernel 10}
      \end{subfigure}
      \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{img/K10.png}
        \subcaption{Kernel 11}
      \end{subfigure}
      \begin{subfigure}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{img/K11.png}
        \subcaption{Kernel 12}
      \end{subfigure}
      \caption{Filter bank of 12 Gabor filters with 4 rotations and a $\sigma_x=1\ ,\sigma_y = 0.5\ $ and $\ f = 0.15, 0.35 \text{ and } 0.4$\label{fig:gaborbank}}%
    \end{figure}
    \noindent
    The filter bank with these kernels act as an edge and structure detection algorithm.\\
    In structured areas with fields or buildings on a street raster, the filter amplifies the structures, for smaller structures the filter detects edges for change in building material. 
    The detection is working due to the different specific albedo of the different frequency bands, depending on material properties. 
    \noindent 
      The result of the convolution of all bands of the image with the Gabor filter was then used as feature vector. 
      By variation of parameters, a minimal error to the reference data was achieved using 4 rotations, an asymmetric kernel with a 2:1 ratio, two frequencies and two sigma sizes (see error calculation below).
      Since the classification was done using a reproducible randomness, the parameters influencing the result where:
      \begin{itemize}
        \item the selected images
        \item the number of classes to find by the k-means algorithm
        \item the parameter of the Gabor filter
      \end{itemize}
      The images were not changed for finding the best filter settings, the number of k-means clusters was varied as well as the parameters of the Gabor kernels. 
      One limit of the Gabor filter parameters (rotation, size and frequency) was given by the resulting increase in processing time, since the resulting feature vector for each band is set as      % 
      \begin{equation}
        N_{feat} = |\theta| \cdot |\sigma| \cdot |f| 
      \end{equation}
      with an increase of any parameter the dataset size increased significantly, creating a limit of the parameter variation. 
    The $1833 \times 1833$ pixel sized image of Bremen (covering a square of $\approx 55$ km around the city centre), has a size of 13 MB per Band\footnote{%
    After feature detection the resulting dataset would be 107 MB per Band resulting in around 1.2 GB for each 8 band Image for each time point within the used classification training dataset.}.
    The optimal sigma was found using systematic variation to be between 1.0 and 1.5. 
    The frequencies of the sine wave where varied between 0.05 and 0.5. 
    A trade-off between computation time and results was found using 3 frequencies shown in \cref{fig:gaborbank}. \\ 
    This step was crucial in extracting and emphasizing spatial patterns and textures, thereby facilitating more distinct classification of land cover types.
      For classifying surfaces the k-means unsupervised machine learning algorithm was used.
      The number of classes was varied between 8 and 12 classes, giving best results in terms of minimal \gls{MSE} and highest \gls{SSIM} when using 11 classes.
      The quality of the feature vectors was judged by the output of the classification that is covered below. 
      The feature enhanced data of images of Bremen were used of multiple years to create the unsupervised k-means clustering model.
      The classified image has 11 classes that are shown in \cref{tab:land_cover_classes}.
      \begin{table}[!htbp]
      \centering
      \renewcommand{\arraystretch}{1.4}
      \caption{Land Cover Classes Identified\label{tab:land_cover_classes}}
      \begin{tabular}{p{1cm}p{4cm} l }
      \toprule
      \textbf{Class Number} & \textbf{Land Cover Type} & \textbf{ESRI Class}\\
      \midrule
      1 &   Water                         & Water / Flooded Vegetation\\
      2 &   Vegetated Residential         & Build Area\\
      3 &   Clouds / PV                   & Build-up\tablefootnote{Analysed images do not contain clouds over the urban areas} \\
      4 &   Fields \& Meadows             & Crops\\
      5 &   Agricultural                  & Crops\\
      6 &   Industry                      & Build Area\\
      7 &   Residential                   & Build Area\\
      8 &   Bare Soil, Rock               & Bare \\
      9 &   Vegetated Residential (moist) & Build Area\\
      10 &  Industry Halls                & Build Area\\
      11 &  Forest / Dense Vegetation     & Trees \& Crops \\
      \bottomrule
      \end{tabular}
      
      \end{table}
      \newpage
      \begin{wrapfigure}{l}{0.48\textwidth}
        \begin{center}
          \includegraphics[width=0.46\textwidth]{img/DiffLULC}
        \end{center}
        \caption{Change between reference product and k-means \gls{LULC} classification}\label{fig:lulcDiff}
      \end{wrapfigure}
      \noindent
      In \cref{fig:lulcDiff} this difference is shown between the 2019 \gls{LULC} and 2022 \gls{LULC}.
      The major differences are all seen outside of the city area and can be attributed to changes on agricultural land, e.g.\ harvesting or change in vegetation type.
      During the available time neither classification nor reference data showed significant land use changes within the urban area of Bremen. 
      The majority of changes occurred at the interfaces between two classes that are caused by errors in georeferencing, naturally occurring changes in vegetation growth and uncertainties due to spacial resolution.
      Due to the missing \gls{LULC} changes within the given time frame, the analysis of the impact of land cover changes could not be completed. 
      In \cref{sec:future} possible areas with \gls{LULC} errors are listed as areas to be studied in the future.
      \newpage
    \subsection{Validation of Classification results}\label{sec:references}
      
      The model was validated using the Sentinel-2 10 m Land Use/Land Cover product~\autocite{Sentiel10mLULC}. 
      Since the reference data uses 8 classes, the used classes where mapped to the best fitting class as indicated in \cref{tab:land_cover_classes}. 
      Clouds, cloud shadows and snow/ice where not used for training and verification and removed for the analysis, since reference images do not contain clouds and images were selected to not contain ice, snow and clouds within relevant areas.
      %Since the datasets used for this analysis where selected to have no cloud cover over the analysis area, cloud pixel in the peri urban area where just excluded from the temperature calculation . 
      The Esri 10m-\gls{LULC} Dataset was obtained using the ESRI land cover explorer~\autocite{Zhang} and scaled to the 30 m resolution of the Landsat images.
      It can be seen from the difference between the \gls{LULC} classification and the main difference in categorization is along the edges between different class patches. 
      This can be explained by differences in the categorization approach, where the reference dataset is using averages for the whole year while the classification for the data is done at a single point in time. 
      This can lead to an over detection of vegetation or water classes due to season or weather impact on the single point in time classification.
      %In \cref{fig:lulcDiff} this difference is shown between the 2019 \gls{LULC} reference and the (filtered) classification of the image taken at the 26-06-2019. \\ 
      % VALIDATION OF CLASSIFICATION
      A simple comparison of difference can be done by calculating the \gls{MSE} for each classification of the image using \cref{equ:mse}, where  $m$ and $n$ are the sizes of the image and reference image respectively. Where I and K images with the pixel values at index i and j. 
      \begin{equation}\label{equ:mse}
      MSE = \frac{1}{m\cdot n} \sum_{i=0}^{m-1} \sum_{j=0}^{n-1} {\left[I\left(i,j\right)-K\left(i,j\right)\right]}^2
      \end{equation}
      The score given by this gives and rough estimation of the difference between the images and the trained model was then used to classify other cities and datasets from different times. 
      Part of the training data as well as different time data from the same area was used and Feature enhanced using the same Gabor-Filter bank.
      \begin{equation}\label{equ:ssim}
      SSIM = \frac{(2\mu_{x}\mu_{y}+c_{1})(2\sigma_{xy}+c_{2})}{(\mu_{x}^2+\mu_{y}^2+c_{1})(\sigma_{x}^2\sigma_{y}^2+c_{2})}
      \end{equation}
      $\mu$ are the mean values of each image, $\sigma$ is the variance of each image and $\sigma_{xy}$ the covariance of each image. $c_{1}$ and $c_{2}$ are stabilizing constants derived from the dynamic range of the image\cite[Equation 6]{Wang2003}.
      For the SSIM the scikit-image implementation was used \autocite{Walt2014}.
      \Gls{SSIM} returns a value between 1 (identical images) and -1 (inverted images) with 0 for images with no similarity \autocite{Wang2003}. 
      The \gls{SSIM} of the images was calculated as 0.98 $\pm 0.001$ showing very high similarity.

      %Feeding the enhanced data into the random forests model was then used to determine the land cover classes for the next step of the analysis.


      %For the labelling of these land cover classes, the Normalized Difference Vegetation Index (NDVI) and the Normalized Difference Built-up Index (NDBI) bands were utilized.
      %These indices were instrumental in differentiating vegetated areas from built-up regions, thereby aiding in the accurate categorization of land cover types.
      \noindent
      The classification labels were assigned, based on the proximity of the cluster centres of the training data, to the cluster centres of the K-means fit (see \cref{sec:labelassignment}).
      This approach ensured that each land cover class was consistently labelled independent of the area of study.
    %
    \subsubsection{Urban Area Extraction}\label{sec:urbanAreaExtraction}
      The resulting classified image was then processed to extract urban areas.
      The algorithm used the classes 1, 2, 6 and 11 from \cref{tab:land_cover_classes} to detect areas that can be considered urban.
      The areas were processed, using \gls{dilation} and \gls{erosion}, to isolate core urban areas. 
      For small gaps between parts of the city, covered by vegetation (parks or railways), dilation was used to bridge gaps and close small holes.
      Small thin links, such as highways, between larger areas are cut, to create separate urban areas.
      After preprocessing the areas were enumerated and all areas that cover at least 1\% of the selected image section where used to create buffer zones. 
      Buffer zones were defined as described in \cref{sec:urbanBufferzone}. 
      The result for the urban area of Bremen can be seen in \cref{fig:bufferedBremen}.\\
      \begin{figure}[!htbp]
        \includegraphics[width=\textwidth]{img/UrbanAreaBremen.png}
        \caption{Urban Area of Bremen, with buffer zones for Adjacent and Peri Urban Area\label{fig:bufferedBremen}}
      \end{figure}
      %For comparison the same buffer zones for a smaller urban area in the same image can be seen in \cref{fig:appxStuhr}
      
    \subsection{Analysis}\label{sec:landcoverAnalysis} 
      The results of this classification can be seen in \cref{fig:classification}. \\ 
      \begin{figure}[!htbp]
       \begin{center}
         \includegraphics[width=\textwidth]{img/Classification.png}
       \end{center}
       \caption{Classification result}\label{fig:classification}
      \end{figure}
    In \cref{fig:ndvilst01} and \cref{fig:ndvilst02} the different pixel values and the measured \gls{LST} and \gls{NDVI} values are plotted of the classified results. 
    Especially the \textit{Water} and \textit{Dense Vegetation} classes are distinctly separated from the rest of the clusters within the \gls{NDVI} and \gls{LST} plane. 
      The scatter plot also shows that the principle components of the classifications are not simply \gls{NDVI} and \gls{LST} but the added feature dimensions play a significant role in separation of classes.\\
      % 
      \begin{figure}[!htbp]
      \begin{subfigure}[b]{\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/NDVI vs LST 2019-06-29.png}
        \subcaption{Classification distribution on a day with higher temperatures}\label{fig:ndvilst01}
      \end{subfigure}
      \begin{subfigure}[b]{\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/NDVI vs LST 2022-06-21.png}
        \subcaption{Classification distribution on a day with lower temperatures}\label{fig:ndvilst02}
      \end{subfigure}
      \caption{Result of clustering plotted with \gls{NDVI} and \gls{LST} values and cluster centres (coloured squares)\label{fig:kmeansclusters}}
      \end{figure}
      %
      \noindent
      The urban area shown in \cref{fig:bufferedBremen} yielded a usable output shape following the Bremen city borders, this was manually verified using the visible images and third party visible satellite images. 
      \Cref{fig:classesPeri} shows the classification of pixels within the peri urban area.\\
      It can be seen, that the pixel of the peri urban area has a mixed surface classes dominated by vegetation classes. 
      Parts of these are removed (\textit{Residential}, \textit{Vegetated Residential}, \textit{Industrial \& Industry Halls} and \textit{Bare Soil}) if in a linked area of more than $\approx$ 25 ha of size, to remove other larger settlements that could distort the measurement.\\
      The temperature values of the different areas are calculated by overlaying the masks on the thermal band of the Landsat data. 
      %
        \begin{figure}[!htbp]
         \centering
         \includegraphics[width=\textwidth]{img/ClassDistributionPU2019-06-29.png}
         \caption{Distribution of surface types within the peri urban area (prior to filtering)}\label{fig:classesPeri}
        \end{figure}
      %
        The average temperature and variance is calculated for the peri urban and the urban area.
        Using the average temperature, \glspl{UHI} are detected using the definition from \cref{ssec:definition} within the area defined by the urban mask. 
        The areas that are above the threshold are then detected within the urban mask, the resulting \glspl{UHI} are shown in \cref{fig:AnalysisBre}. 
   \begin{figure}[!p]
       \begin{subfigure}{\textwidth}
          \centering
          \includegraphics[width=0.8\textwidth]{img/UHIs_Bremen_2019-06-29_s:3}
         \subcaption{Map of the detected UHIs in June 2019}\label{fig:uhis2019}
       \end{subfigure}

       \begin{subfigure}{\textwidth}
          \centering
          \includegraphics[width=0.8\textwidth]{img/UHIs_Bremen_2022-06-21_s:3}
         \subcaption{Map of the detected UHIs in June 2022}\label{fig:uhis2022}
       \end{subfigure}
         \caption{Overview of Bremen \glspl{UHI} at different times}\label{fig:AnalysisBre}
   \end{figure}
   The white area is the urban mask of Bremen and the detected \glspl{UHI}, are circled in black. 
   \Cref{fig:uhiAffected} shows areas with urban heat islands at both times. 
   The found areas could be further investigated, if health risks or high heat have negative side effects within these areas.\\
      %
      \begin{figure}[!p]
          \centering
          \includegraphics[width=\textwidth]{img/overlap.png}
         \subcaption{Areas overlap of detected UHIs}\label{fig:uhiAffected}
      \end{figure}
      %
      In \cref{fig:lstclusters19} and \cref{fig:lstclusters22}, the temperature distributions within the different classes is shown (the whole image was used for the statistic). 
      Confirming previous research, classes with high vegetation and water are lower in temperature. 
      The 2022 day was colder, with mixed cloud cover, explaining the significantly lower temperature of PV / Cloud classes.
      The PV / Clouds class also included some cumulus clouds outside of the city area further decreasing the temperature values within this class. 
      This distribution matched the expected peri urban distribution, prior to removal of close by larger settlements. 
       \begin{landscape}
         \begin{figure}[!p]
           \centering
           \includegraphics[width=0.91\linewidth]{img/LST vs surface type with (11 clusters) - 2019-06-29.png}
           \caption{Distribution of pixel \gls{LST} [°C] values per class June 2019 \label{fig:lstclusters19}}
         \end{figure}

         \begin{figure}[!p]
           \centering
           \includegraphics[width=0.91\linewidth]{img/LST vs surface type with (11 clusters) - 2022-06-21.png}
           \caption{Distribution of pixel \gls{LST} [°C] values per class June 2022 \label{fig:lstclusters22}}
         \end{figure}
       \end{landscape}
       %
       \noindent
       \Cref{fig:ndviclusters2019} and \cref{fig:ndviclusters2022} show the \gls{NDVI} values of the same classes.
       One unexpected observation is the wide spread of the water class over the whole range of the \gls{NDVI}, where it is expected to be $\le$ 0. 
       This can be explained by the fact that the highly vegetated riverbank areas are also classified as water based on the additional features, changing the \gls{NDVI} values assigned to this class.
      To calculate the diff between \gls{LULC} at different points in time, a median filter is applied to reduce single pixel changes at class interfaces. 
       \begin{landscape}
         \begin{figure}[!p]
           \centering
           \includegraphics[width=0.91\linewidth]{img/NDVI vs surface type with (11 clusters) - 2019-06-29.png}
           \caption{Distribution of pixel \gls{NDVI} values per class 2019\label{fig:ndviclusters2019}}
         \end{figure}

         \begin{figure}[!p]
           \centering
           \includegraphics[width=0.91\linewidth]{img/NDVI vs surface type with (11 clusters) - 2022-06-21.png}
           \caption{Distribution of pixel \gls{NDVI} values per class 2022\label{fig:ndviclusters2022}}
         \end{figure}
       \end{landscape}
      \noindent
      Each detected \gls{UHI} was further investigated by detecting the dominating class within the \gls{UHI} area. 
      The separated classes are plotted against \gls{UHI} $T_{max}$ in \cref{fig:tempInUHIs}
      Industrial and sealed surfaces are the most common class found within areas affected by \gls{UHI}.
      Very few \glspl{UHI} classes were dominated by any class associated with high vegetation.
      The image shows, that the residential area includes the hottest \gls{UHI} while Industrial UHI have a higher average max temperature. 
      %After referencing the  data it was shown that there where no significant LULC changes within the city area of Breme
      \begin{figure}[!htbp]
      \begin{subfigure}[b]{\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/Temperature and majority surface type in UHIs (2019-06-29).png}
        \subcaption{2019}\label{fig:majorityClasses}
      \end{subfigure}

      \begin{subfigure}[b]{\textwidth}
        \centering
        \includegraphics[width=\textwidth]{img/Temperature and majority surface type in UHIs (2022-06-21).png}
        \subcaption{2022}\label{fig:majorityClasses2}
      \end{subfigure}
      \caption{Analysis of the majority classes within areas of \glspl{UHI} and the associated temperature distribution\label{fig:tempInUHIs}}
      \end{figure}  
      
 \subsection{Conclusions}

    The usage of Landsat imagery, with a Gabor filtering, K-means based classification constituted a robust methodology for land cover classification.
    The filter parameters on the Gabor filter were optimal with an absolute MSE of 0.3 $\pm 0.05$ (class values 0 = water, 1 = urban and 2 = non-urban) for two years of classification, which is an error of 10\%.
    Using the more detailed \gls{SSIM}, the index is 0.98 $\pm 0.001$ showing very high similarity (1 would be identical images, -1 inverted images and 0 for no similarity). 
    These metrics were found highest with a filter bank of 12 asymmetric $7\times7$ px kernels, using 3 frequencies, 4 rotations and a sigma of $1.0$ and $0.5)$ in x- and y- direction respectively (see \cref{fig:gaborbank}).
    The number of classes that are distinguishable varies by season and is limited by computing power, one possible improvement is the use of \textit{reducing machine learning algorithms}, that identifies the principle components that have less variance between seasons.
    Additionally using parallelization by means of libraries such as \textit{dask}~\autocite{dask}, allow bigger filter banks and additional steps to the pipeline to increase output quality.
    Another simple way that was not utilized was to incorporate the QA layer provided by the Landsat L2 data product, that provide per pixel probability values for water and cloud detection, that could remove outliers in the water and cloud classes and therefore provide higher quality results for the other classes. 
    %
    One way of increasing accuracy of the results is an increase in resolution, that allows the Gabor filter bank to have a wider range for usable values. 
    In \cref{fig:gaborbank} it can be seen that the first kernel of each rotation is nearly identical, due to to missing resolution. 
    This would allow to detect smaller features.
    Another improvement might be the implementation of weights for the feature and original image values.
    Due to the missing changes within the image time frame no impact on the urban heat islands within Bremen due to urbanization or construction can be seen. 
    The analysis of the classes dominant in the \gls{UHI} clearly show that the surface type does have an significant influence on the creation of urban heat islands. 
    Industrial and sealed surfaces are the most common class found within areas affected by \gls{UHI}.
    No \glspl{UHI} had an majority of pixels associated with high vegetation. 
    %TODO maybe add check if really identical or off by a bit
    
  \newpage
  \section{Impact of Climate Change on Urban Heat Islands}\label{sec:UHITempImp}
    \subsection{Introduction}
      The interaction between global and local climate is a complicated process that has multiple parameters, and is not yet fully understood or directly measurable (see \cref{sec:intro}).  
      While rural areas and the global south is most effected in terms of temperature increase and drought, the excess mortality of heat waves is greatest within city areas~\autocite{Gabriel2011}. During high temperatures the threshold of negative health effect shows to be lower in northern European cities compared to Mediterranean cities~\autocite{Baccini2008}. 
      The negative health consequences and increased mortality is affecting elderly the most and the excess mortality is an immediate effect \autocite{Baccini2008}. 
      In western Europe the climate is governed by a transitional climate, with attributes from maritime and continental climate.
      The summer is, compared to southern Europe, milder and not regularly affected by burning and heat waves. 
      The temperatures in major European cities have increased at a similar pace than the global mean temperatures. 
      In Bremen, the 5-year-average temperature has risen from 1990 (13.79\textdegree\ C)  by 1.4\textdegree\ C to 15.20\textdegree\ C in 2020.
      The change over the past 20 years in monthly averages is shown in \cref{fig:monthAvg}.
      \begin{figure}[!htbp]
          \centering
          \includegraphics[width=\textwidth]{img/BremenClimateAvgDiff2023.png}
          \caption{Change of monthly air temperature average compared to average of 1981--2010~\autocite{DWD2024a}\label{fig:monthAvg}}
      \end{figure}
      %The hypothesis is that the rising temperatures observed over the past 30 years have increased heat island severity and size. 
    \subsection{Methodology}
      Measurement of the impact of rising temperatures have to be done after correcting for other variables such as urban development and meteorological impact factors such as wind and rain. 
      To achieve this, a time series of land surface temperatures and \glspl{UHI} from 1990 to 2022 was created using Landsat 7 and Landsat 8 and 9 data.
      Data from two weather stations in the areas were used to calculate the trend of mean temperature over the time. 
      The \glspl{UHI} data was then correlated with the air temperature data of the local measurement stations and corrected for size increases of \gls{UHI} impacted by land cover change in the previous step. 
      This way all \glspl{UHI} that would be impacted by urbanisation or change of surface type were excluded from the analysis.
    \subsubsection{Data Handling}
      One of the challenges arising during the processing of multiple images were the large amount of data of the images and feature bands. 
      To reduce the memory footprint of the processing chain, xarray \autocite{hoyer2017xarray} was used. 
      Xarray allows lazy loading from disk, this only loads parts of the complete dataset. 
      Another feature of xarray that was used are labelled data. Each loaded image used latitude and longitude as coordinates allowing to accessing sub areas by reference coordinates. 
      Another axis was added for the time dimension, so that each area could be stored in a single data file, but access is done loading only the relevant data for a specific time or a selected time frame.
  
      For this step the following data was loaded from the previous dataset: 
      \begin{itemize}
        \item Band data from the area of interest (Band 1 to 10)
        \item Classification label, a layer with the numerical classifications assigned to each pixel 
        \item Urban mask, a layer with urban, suburban and peri-urban areas
        \item \glspl{UHI}, for each time step a layer, masking urban heat islands
      \end{itemize}
    \subsubsection{Land Surface Temperature Calculation}\label{sec:lstcalc}
      The \gls{LST} can not be measured directly by a satellite but must be calculated from the upwelling thermal infrared radiation and corrected for the atmospheric perturbation. 
      For Landsat 7 and Landsat 8 data is provided in different processing levels.
      For analysis of past data that has already be processed the level 2 data can be used, that provides land surface temperature and has been calculated from the level 1 data. 
      \glsreset{TOA}%reset TOA acro
      To derive the level 2 data from level 1 data, \gls{TOA} brightness is used, corrected for stray light (Landsat 8 specific, see~\autocite[p.~67]{Zanter2019}) and instrument distortion. 
      Geometric and geographic terrain-correction (\cite[p.~44]{Zanter2019}) is applied, resulting in an geolocalized image.
      The \gls{TOA} temperature data is calculated according to \cref{equ:toa}, where $K_1$ and $K_2$ are band specific conversion factors from the meta data file and $L_\lambda$ is the spectral radiance at the \gls{TOA} in $\frac{W}{m^2\cdot srad \cdot \mu m}$ e.g.\ the Band 10 Channel. 
      \begin{equation}\label{equ:toa}
  	    T = \frac{K_2}{\ln\left(\frac{K_1}{L_{\lambda}}+1\right)}
      \end{equation}
      To get the level two data from these \gls{TOA} measurements the value is corrected for emissivity of the ground using measurements from the \textit{ASTER GED} database (see~\cite{USGSWebsite}).\\
      The temperature is also corrected for atmospheric interference using local reference stations. 
      The \gls{USGS} uses reference stations, atmospheric models and independent reference measurements from other satellites to calculate the surface temperature. 
      The surface temperature product has an accuracy of $\pm 1 K$ overall and other uncertainties are marked in a quality assurance file provided for each image.\\
      To convert the image file containing 16 bit, unsigned integers into a temperature \cref{equ:tiftolst} is used. The scaling and offset factors are specific to the product and were taken from~\cite[Table 6-1]{EROASC2013}.
      % 
      \begin{equation}\label{equ:tiftolst}
        T_C = T_K - 273.15 = \text{DN} \cdot 0.00341802 + 149.0 - 273.15 
      \end{equation}
      Where DN is the \textit{Digital Number} (a 16 bit integer) stored in the image file, the multiplication factor as well as the 149.0 offset are provided in the meta data file and in the Landsat user manual~\autocite{EROASC2013}. 
      The accuracy of the resulting temperature value is given by the user manual as also $\pm 1$~K.
      %\newpage
    %
    \subsubsection{Local temperature rise}
      For investigating a city, the next ground based measurement stations was used as reference. 
      This data was correlated with the \gls{SUHI} intensity as well as the measured temperature data from the times of the satellite data acquisitions. 
      For German cities the stations of the \gls{DWD} are used, these have very accurate readings and a long archive of measurements.
      One indicator interesting in the research on \glspl{UHI} is the number of days with very high temperatures.
      There are multiple threshold days that are used to classify seasons in comparison to the average.
      Hot days (defined by the \gls{DWD} as days with a maximum temperature over 30 °C), summer days (maximum temperature over 25 °C) and tropical nights (days with daily minimal temperature over 20 °C), are tracked by meteorological organisations~\autocite{dwdklimalexikon}.
      Another measurement to visualize a rise in average temperature is the amount of frost days (where the minimal temperature is below 0 °C). The \cref{fig:breTempExtr1} and \cref{fig:breTempExtr2}, show the development of these indicators for Bremen over the past 82 and 32 years respectively.
    \begin{table}[ht]
        \centering
        \caption{Bremen weather data using data from~\cite{DWD2024a}\label{tab:statsBremen}}
        \renewcommand{\arraystretch}{1.4}
        \begin{tabular}{p{3.4cm}p{2.5cm}lp{2.5cm}}
          \toprule
          & \textbf{Extremly Cold} & \textbf{Average} & \textbf{Extremly Warm} \\
          & min & mean & max \\
          \midrule
          Annual average °C \newline (Jahr)     &   7.2 \newline(1940)       & 9.4    & 11.1\newline (2020)      \\
          Abs. T °C \newline (Jahr)             & -23.6 \newline(Feb. 1940)  &        & 37.6 \newline(Aug. 1992) \\
          Summer days \newline($T_{\max}~\ge$  25 °C) & 4                    & 27.7   & 78 \\
          Hot days \newline($T_{\max}~\ge$  30 °C)    & 0                    & 4.9    & 22 \\
          \midrule
          & max & mean & min \\
          \midrule
          Frost days \newline($T_{\min}~<$  0 °C)     & 105         & 70.8   & 24 \\
          Ice days \newline($T_{\max}~<$  0 °C)       & 54          & 14.9   & 0  \\
          \bottomrule
        \end{tabular}
      \end{table}
\newpage
\begin{landscape}
      \begin{figure}[!p]
          \includesvg[width=0.89\linewidth]{img/hotdaysbremen_s1940}
        \caption{Number of cold and hot days over time in Bremen, Germany 1940-2022\label{fig:breTempExtr1}}
      \end{figure}
\end{landscape}
\begin{landscape}
      \begin{figure}[!p]
           \includesvg[width=0.89\linewidth]{img/hotdaysbremen_s1990}
           \caption{Number of cold and hot days over time in Bremen, Germany 1990-2022\label{fig:breTempExtr2}}
      \end{figure}
\end{landscape}
    \subsection{Analysis}\label{sec:tempanalysis}
      Bremen was selected as the base area of the study, to be able to verify classification results using personal local knowledge. 
      The study area covers the city centre of Bremen and an area of 27 km in all directions covering an area of approximately $3000\ km^2$. 
      The study area is at sea level elevation and has a temperate-oceanic climate according to the~\cite{koppen1930handbuch} classification.
      An overview of the climate of Bremen is shown in \cref{tab:statsBremen}.
            The development of threshold days over time are shown in \cref{fig:breTempExtr1}, the strongest change can be seen in \cref{fig:breTempExtr2} and the downward trend in frost days. 
      Together with the increase in tropical nights over the past five years and the increased appearance of hot days for the past 3 years after 6 decades with no or one hot day per decade, this fits the trend of global rise in temperatures.\\ \\ 
      % 
      The weather station in Bremen is located at the airport on the edge of the city area. 
      % 
      For comparison of air temperature with a more rural area the \gls{DWD} weather station ``Worpswede-Hüttenbusch'' located roughly 30 km north-north-east of the weather station and is located in a rural area (see \cref{fig:mapWeatherstationsBremen}).
  \begin{figure}[!htbp]
         \centering
            \includegraphics[width=\textwidth]{img/MapWetterstationenBremen.jpeg}
             \caption{Location of the weather stations in Bremen and the rural reference station in Worpswede-Hüttenbusch}\label{fig:mapWeatherstationsBremen}
      \end{figure}
      % 
      To verify that the measurements of the urban and rural stations, the difference in daily measurement values of both stations is shown in \cref{fig:diff2015Bre} and \cref{fig:diff20222Bre}. 
      It can be seen that the atmospheric \gls{UHI} over Bremen is affecting the Bremen airport station. 
      In the period from April to October in 2015 the daily mean temperature was 0.6 \textdegree\ C lower at the rural station. 
      In the same period in 2022 the daily mean temperature was 0.85 \textdegree\ C lower at the rural station. 
      The Stations are calibrated to provide comparable weather data with high levels of accuracy (error smaller $\pm 0.2$\textdegree\ C \autocite{LES2024}). 
      \Cref{fig:tempurbvsrural} shows the offset of minimum, maximum and mean temperature daily temperature over the year. 
      This indicates that the atmospheric heat island of Bremen is affecting the airport weather station.
      \begin{figure}[!htbp]
        \begin{center}
        \includegraphics[width=\textwidth]{img/Mean temperature difference between rural and urban station - Bremen.png}
         \end{center}
         \caption{Mean yearly station offset urban rural station}\label{fig:tempurbvsrural}
      \end{figure}
      \noindent
      \Cref{fig:diff2015Bre} and \cref{fig:diff20222Bre} exemplary show the lack of usable satellite imagery for Bremen in green. 
      Especially finding cloud free cover of the area with similar seasonal and weather patterns was difficult.
      
      \begin{landscape}
      \begin{figure}[!p]
         \centering
          \includegraphics[width=0.89\linewidth]{img/BremenDifference2019.png}
          \caption{Absolute Differences between measurement stations [°C] and days with satellite coverage (green) in 2015}\label{fig:diff2015Bre}
      \end{figure}

      \begin{figure}[!p]
          \includegraphics[width=0.89\linewidth]{img/BremenDifferences2022.png}
          \caption{Absolute Differences between measurement stations [°C] and days with satellite coverage (green) in 2022}\label{fig:diff20222Bre}
        \end{figure}
      \end{landscape}
      %To test if the temperature in the weather stations was significantly offset a \gls{WilMannWhitTe} was performed on the datasets.
      %The test showed a significant offset for the minimum and mean temperature.
      % 
      \noindent
      \Cref{fig:AnalysisBre} shows two summer days in Bremen with different temperatures and the influence of temperature onto the \glspl{UHI} size and shapes. 
      In the image from 2019 (\cref{fig:uhis2019}), the average temperature was much higher at the time. 
      It can be seen that the heat islands, while statistically the same difference to the peri urban temperature, increase in size and combine into larger structures. 
      In \cref{tab:UHIBremenStats} the statistical properties of the \gls{UHI} for different days within the urban area is shown.
      \begin{figure}[!htbp]
        \centering
         \begin{subfigure}[b]{0.80\textwidth}
           \includegraphics[width=\textwidth]{img/sizeVsTempmean2019-06-29 00:00:00.png}
           \subcaption{2019}
         \end{subfigure}

         \begin{subfigure}[b]{0.80\textwidth}
           \includegraphics[width=\textwidth]{img/sizeVsTempmean2022-06-21 00:00:00.png}
           \subcaption{2022}
         \end{subfigure}
         \caption{Maximum Temperatures of the detected \glspl{UHI} and area above threshold}\label{fig:tempvssize}
      \end{figure}
%   
\begin{landscape}
  \begin{table}[ht]
    \renewcommand{\arraystretch}{1.4}
    \centering
    \caption{Comparison of Air Temperature, \gls{LST} and \gls{UHI} size for Bremen\label{tab:airtempHB}}
    \begin{tabular}{l lll lll l lll c lll}
      \toprule
        &\multicolumn{7}{c}{\makecell{\textbf{Air Temperature}}} & \multicolumn{3}{c}{\makecell{\textbf{LST}}}\\
      \textbf{Date}&\multicolumn{3}{c}{\makecell{\textbf{Urban}}} &\multicolumn{3}{c}{\makecell{\textbf{Rural}}} & \textbf{$\Delta T$} &
      \multicolumn{3}{c}{\makecell{\textbf{Urban}}}& \multicolumn{3}{c}{\makecell{\textbf{Rural}}}\\

                                                   & $T_{\min}$ & $T_{mean}$ & $T_{\max}$ & $T_{\min}$ & $T_{mean}$ & $T_{\max}$ & & 
      $T_{\min}$ & $T_{mean}$ (std) & $T_{\max}$ & Num. UHIs & $T_{\min}$ & $T_{mean} (std)$ & $T_{\max}$ \\
      \midrule
      2019--06--29 & 15.9 & 24.7 & 31.9 & 17.7 & 25.4 & 30.7 & -0.7 & 22.9 & 34.2 (3.5) & 61.4 & 102 & 22.92 & 35.2(3.77) & 61.4 \\
      2022--06--21 & 6.9  & 15.7 & 22.3 & 7.6 & 15.6 & 23.0 & -1.0 & 4.4 & 29.0 (4.4) & 56.7 & 34 & 4.7& 29.7 (4.4)& 56.7 \\
      \bottomrule
    \end{tabular}
  \end{table}

    \begin{table}[ht]
      \renewcommand{\arraystretch}{1.4}
      \centering
      \caption{Comparison of Urban Heat Islands in Bremen over time\label{tab:UHIBremenStats}}
      \begin{tabular}{l lll lll}
        \toprule
        \textbf{Date}& Number UHIs & min area [$m^2$]& mean area [$m^2$]& max area [$m^2$]& $\text{UHI}_{\text{max}}~\text{T}_{mean}$ [°C]& $\text{UHI}_{max}~T_{max}$ [°C]\\
             \midrule
        2019--06--29 & 102 & 4500 & 74691 & 962100  & 47.7 & 52.0 \\
        2022--06--21 & 34 & 4500   & 58950 & 370800  & 46.4 & 51.6 \\ 
        \bottomrule
      \end{tabular}
    \end{table}
  \end{landscape}
   % 
    The analysis of the \glspl{UHI} at the analysed dates, shows a strong increase in maximum and average heat island size, with rising temperatures. 
    \Glspl{UHI} smaller then 5 pixel (4500 m$^2$) were excluded, to mitigate impact of outliers. 
    \Cref{fig:tempvssize} shows the distribution of sizes and maximum temperatures within the \gls{UHI}.
    Most heat islands are small with a wide range of temperatures, the few very big heat islands are within the mid range of temperatures. 
  %
\newpage
\section{Conclusion}\label{sec:conclusion}
  Due to the limited remote sensing data availability at summer dates with similar weather, statistical analysis is not conclusive. 
  There is an increase in number, mean size and maximum size visible with rising average temperatures. 
  The maximum temperatures are very similar and do not increase linearly with average temperatures. 
  % 
  Analysing each \gls{UHI} for more parameter and using measurements from different sources, e.g.\ ground measurement campaigns to refine and verify measurements.
  The data indicates size increases of \glspl{SUHI} with rising temperatures, due to lack of measurement stations there is no data on the impact of the inner city air temperature distribution.
  In the following sections the answers to the research questions are recapitulated.

  \subsection{What definition can be used to define \glspl{UHI} comparably?}\label{a1} 
   An \gls{SUHI} is an area with increased surface temperature within an urban space. 
   It is defined as having a temperature at least 3 standard deviations above the average temperature of the adjacent rural buffer zone. 
   This measurement is corrected for larger settlements.
   This definition can be used to compare urban areas in different settings and surroundings. 

  \subsection{What is the influence of \gls{LULC} change on the size of urban heat islands?}\label{a2}
   A strong correlation exists between dominant surface types and urban heat island size. 
   Surfaces with high \gls{NDVI} and low surface sealing tend to have lower temperatures. 
   Consequently, these areas feature few, if any, urban heat islands.
  
  \subsection{How significant is the impact of urbanisation on \glspl{UHI}, both in terms of absolute and relative temperature changes?}\label{a3}
   Sealed surfaces and industrialized areas are most impacted by and are major sources of urban heat islands, regardless of average reference temperature.
   Surface types typically associated with urbanisation and human activity, are most affected by \glspl{UHI}.
   These Surfaces are bare, sealed areas (parking lots, runways, bare ground and industry lots), industrial areas and high density residential and commercial zones, commonly found within city centres.
   The study area did not allow to investigate areas impacted by surface type changes, due to lack of a large enough change within the observed time frame.
   The strong correlation and other studies show that urbanization without mitigations is a strong driver for \glspl{UHI} formation.
   
  \subsection{What is the effect of rising average temperatures on the \glspl{UHI} effect?}\label{a4}
   The weather data from the \gls{DWD} shows an increase of average temperature from 1990 to 2020 of 1.4 °C average yearly temperature. 
   Combined with the findings of the influence of average temperature on \glspl{UHI} size increase, this subject could be investigated further.
   To answer this question with a significant statistical analysis, additional satellite imagery is needed (e.g. Landsat-7 or Sentinel-3 footage, if enhanced with a super resolution algorithm)
   
 \subsection{What indices can be used or created to categorize and rate \gls{UHI} intensity?}\label{a5}
   The use of indices like the \gls{HI} (see \cref{sec:heatIndex}) and \gls{WBGT} (see \cref{sec:WBGT}) are useful tools to measure and predict the danger and risk of \gls{UHI}.
   One requirement for the use of these are either weather stations within areas affected by \glspl{UHI} or a model transforming LST to air temperature values. 

\subsection{Summary}
    The study shows that even in higher latitudes the surface temperatures caused by anthropogenic surface modification causes high surface temperatures. 
    The impact of climate change indicates an increase of hot days and tropical nights in temperate climate zones, increasing the risk of negative health effects and dangerous air temperatures during summer and heat waves.\\% 
    It was also shown that Landsat data can independently be used for surface classification with high accuracy compared for single day classification, when combined with feature engineering such as Gabor filters using unsupervised machine learning.
    At time of the study the availability of cloud free remote sensing data posed a severe hurdle. 
    The proposed statistical definition could be helpful to compare \glspl{UHI} in different climate zones and seasons. 
    Urban area extraction, adapted from the suggestion of~\cite{Sobrino2020} approach, has shown to follow the natural borders of the city well.
    All posed questions were answered but the results where inconclusive due to the lack of data or land cover change.
    The work showed that there are insides to be gained by the study of \glspl{UHI}, even in cities at higher latitudes. 
    Rising global temperatures show the need for scientific understanding and pose multiple opportunities for modelling and investigating the \gls{UHI} phenomena further.
    The results may help future research by showing what areas are to be investigated and what approaches and indices can be used to measure health impact and danger of \gls{UHI}.
 % Summary of the findings 
% contributions to research

 \subsection{Limitations and Challenges}
 % Why was something not possible
   While the connection of ground based sensor stations with remote imagery works well, a direct reliable conversion from land surface temperatures to air temperature, since there is a temporal and seasonally different energy transport between surfaces and surrounding air. 
   Another limiting factor was the availability of suitable cloud free satellite footage of the area of study.
   While with the introduction of Landsat 9, the amount of footage doubled, in regions with high cloud cover (like Bremen) and due to the not evenly distributed coverage times of the satellites (2d apart), this resulted in very few images that were useable for the statistical analysis. 
   Due to the low numbers, the results are not statistically relevant and another satellite product or future results need to be used to come to a significant outcome. 
   Observing the impact of land cover change another study area is needed, where significant land cover changes are done. 
   This could be areas that have high growths or construction (see~\cref{sec:future}) or areas that were impacted by catastrophes or war, artificially changing the surface properties 

 \subsubsection{Data}
  Another limiting factor was the availability of suitable cloud free satellite footage of the area of study.
  While with the introduction of Landsat 9, the amount of footage doubled, in regions with a lot of cloud cover like Bremen, the amount of usable footage is very limited.

 \subsubsection{Software}\label{sec:sw}
  For the analysis of the \gls{AoI}, a python application and script assortment was developed. 
  It has was developed with adaptability in mind so that the 
  The software was written in python code used for generating the data, the documentation of the code is located within the doc folder.
  The main.py is documented using the --help option.
  This file provides download and classification of Landsat data.\\ 
  The LST2.py file can be run to detect urban heat islands when the classification was done previously. 
  The integration of this part into the main.py functionality is still outstanding. 
\input{futureWork.tex}
\newpage
\section{Appendix}
  \subsection{Use of AI based tools (Nutzung KI basierte Anwendungen)}
  According to the \textit{Eigenständigkeitserklärung} \cref{sec:eigenstaendigkeit} the use of so called AI tools needs to be declared. 
    During this work the following tools were used: 
  \begin{itemize}
    \item OpenAIs ChatGPT \autocite{chatgpt} for aid during programming, help with formulations, getting topic overviews and aid in finding keywords for further research.
    \item Kagi's summerizer \autocite{kagi}, to deem papers relevant.
    \end{itemize}
    All informations from these tools were used as an aid and were always cross-checked with primary sources. 
  \subsection{Content of the Data Storage device}
    All data and the software used to create the figures and images for this document are available on the storage device.
    The software is also available online in the linked GitHub repository.
    The software version last used for this document is tagged with the name: \texttt{master-submission}
    The following artefacts can be found in these locations.
  \subsubsection{Additional Figures}
    Additional Figures can be found in the ``Image'' folder on the storage Medium.
  \subsubsection{Data}
    The data is stored in multiple subfolders. 
    The \texttt{Data} folder contains the different cities as subfolders, within each of these folders, there is a \texttt{dataset} folder, containing a \texttt{xarray} dataset named \textit{dataXarrayCITY\_NAME.nc} of the used area of interest, including all bands and the classifiction at all times analysed during this project. 
    The \texttt{dataXarrayCITY\_NAME\_feat.nc} contains the extracted feature bands from the Gabor feature extraction.
    The \texttt{ML\_Model} folder contains a ``pickeled'' k-means model, a file containing a numpy array with cluster centres for the label assignment. 
  \subsubsection{Code}\label{sec:code}
      The folder app contains the python code used for generating the data, the documentation of the code is located within the doc folder.
      For the description and starting point of the software see \Cref{sec:sw}.
      The following folder structure was used for the code artefacts:
      \begin{itemize}
        \item The main folder contains scripts that run and process data directly
        \item The folder \textit{preprocessing} contains scripts for processing and preparing land sat images
        \item The \textit{processing} folder contains scripts to calculate different indices and prepare the surface classification of the Landsat Data
        \item The \textit{visualisation} folder contains helper functions for plotting images 
      \end{itemize}
  %
  %
\newpage
\printbibliography%
%maybe use hoffset=-X 
\newpage
\newgeometry{top=2cm, bottom=2cm, left=2cm, right=2cm, head=18pt}
\addcontentsline{toc}{section}{\nameref{sec:eigenstaendigkeit}}
\section*{Eigenständigkeitserklärung}\label{sec:eigenstaendigkeit}
\begin{figure}[!b]
    \includegraphics[width=0.92\textwidth,page=1]{res/eigenstaendigkeitserklaerung_f.pdf}
\end{figure}
\newpage
\begin{figure}[!b]
    \includegraphics[width=0.92\textwidth,page=2]{res/eigenstaendigkeitserklaerung_f.pdf}
\end{figure}
%\includepdf[pages=-]{res/eigenstaendigkeitserklaerung_f.pdf}
\restoregeometry%
\end{document}

%The surface classes were correlated with the \todo[inline,size=\tiny]{ check }
%Kataster data from Bremen as well as with OSM data. % todo do 
%
%Ziel Projekt teil: 
%- detection and error margins in UHI detection using remote sensing data 
%- data pipeline to create maps of UHI in areas 
%- surface classification based on remote sensing data correlated with 2nd and 3rd sources (kataster/ OSM) 
%- UHI "cores" identification 
%
%Master Fragestellungen: 
%- Correlation zw. UHI} und Pollutants? 
%https://pubs.acs.org/doi/epdf/10.1021/cr5006815 
%- Real time UHI size/occurrence prediction based on ground temperature stations (Bremen Airport) and pollutant levels? 
%- UHI classification in different environments, causes and effects, mitigation stategies? (e.g. Classification of Surface types, vegetation etc. within different climate zones (Phoenix, Bremen, Karlruhe, Essen, Something meditareiean, Afrika (coastal, arid, etc) /paper with adis abbeba)
%
%\subsection{}

%Of the different bands available from the used satellite data (Landsat7 and Landsat8), 
%the visible and near infrared bands were used for clustering. 
%The clustering was done using the simple k-means algorithm. 
%Different configuration were used %todo add pictures? 
%These were compared and referenced with ground truth data %todo add error and limitations refgerenec here 


